(function(){function a(b,c){if(b){var d=Object.getOwnPropertyDescriptor(b,c);return d||a(Object.getPrototypeOf(b),c)}}function b(b,c,d){var e=a(c,b);Object.defineProperty(d,b,e)}function c(a){return"object"==typeof Node?a instanceof Node:a&&"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName}function d(a,b){return function(c,d){var e=j.attr(c,d)||{};if(e.type!==a)return void j.warn("Can only indicate one type attribute for %s.%s.",j.getClassName(c),d);if(e.hasOwnProperty("default")){var f=Array.isArray(e["default"])||s(e["default"]);if(!f){var g=typeof e["default"];g===a?j.warn('No needs to indicate the "%s" attribute for %s.%s, which its default value is type of %s.',b,j.getClassName(c),d,a):j.warn('Can not indicate the "%s" attribute for %s.%s, which its default value is type of %s.',b,j.getClassName(c),d,g),delete e.type}}}}function e(a,b,c){var d;return d=b?function(){this._observing=!1,w(this,d),b.apply(this,arguments)}:a?function(){this._observing=!1,w(this,d),c.apply(this,arguments)}:function(){this._observing=!1,w(this,d)}}function f(a){return"function"!=typeof a?void j.error("Constructor of FireClass must be function type"):a.length>0?void j.warn("Can not instantiate FireClass with arguments."):void 0}function g(a,b){b&&(a.toString=function(){var a=Function.toString.call(this);return a.replace("function ","function "+j.getClassName(this))})}function h(a){var b=a.constructor.prototype;return b.hasOwnProperty("__cid__")?a.__cid__:b.hasOwnProperty("__classname__")?a.__classname__:""}var i=this,j=i.Fire||{};if(j._customAssetMenuItems=[],j.addCustomAssetMenu=function(a,b,c){j._customAssetMenuItems.push({customAsset:a,menuPath:b,priority:c}),j.sendToPages&&j.sendToPages("asset:refresh-context-menu")},j.isNode=!("undefined"==typeof process||!process.versions||!process.versions.node),j.isNodeWebkit=!!(j.isNode&&"node-webkit"in process.versions),j.isAtomShell=!!(j.isNode&&"atom-shell"in process.versions),j.isApp=j.isNodeWebkit||j.isAtomShell,j.isPureWeb=!j.isNode&&!j.isApp,j.isEditor=j.isApp,j.isWeb=j.isAtomShell?"undefined"!=typeof process&&"renderer"===process.type:"undefined"==typeof __dirname||null===__dirname,j.isEditorCore=j.isApp&&!j.isWeb,Object.defineProperty(j,"isRetina",{get:function(){return j.isWeb&&window.devicePixelRatio&&window.devicePixelRatio>1}}),j.isNode)j.isDarwin="darwin"===process.platform,j.isWin32="win32"===process.platform;else{var k=window.navigator.platform;j.isDarwin="Mac"===k.substring(0,3),j.isWin32="Win"===k.substring(0,3)}var l=1,m=2,n=4,o=8,p=16,q={DontSave:n,EditorOnly:o,Dirty:p,Destroying:512,HideInGame:1024,HideInEditor:2048,IsOnEnableCalled:4096,IsOnLoadCalled:8192,IsOnStartCalled:16384};q.Hide=q.HideInGame|q.HideInEditor,j._ObjectFlags=q;var r=~(m|p|q.Destroying|q.IsOnEnableCalled|q.IsOnLoadCalled|q.IsOnStartCalled);j.JS={clear:function(a){for(var b=Object.keys(a),c=0;c<b.length;c++)delete a[b[c]]}},j.addon=function(a){"use strict";a=a||{};for(var c=1,d=arguments.length;d>c;c++){var e=arguments[c];for(var f in e)f in a||b(f,e,a)}return a},j.mixin=function(a){"use strict";a=a||{};for(var c=1,d=arguments.length;d>c;c++){var e=arguments[c];if(e){if("object"!=typeof e){j.error("Fire.mixin called on non-object:",e);continue}for(var f in e)b(f,e,a)}}return a},j.extend=function(a,b){function c(){this.constructor=a}if(!b)return void j.error("The base class to extend from must be non-nil");if(!a)return void j.error("The class to extend must be non-nil");for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a},j.getClassName=function(a){if("function"==typeof a&&a.prototype.__classname__)return a.prototype.__classname__;if(a&&a.constructor){if(a.constructor.prototype&&a.constructor.prototype.hasOwnProperty("__classname__"))return a.__classname__;var b;if(a.constructor.name&&(b=a.constructor.name),a.constructor.toString){var c,d=a.constructor.toString();c=d.match("["===d.charAt(0)?/\[\w+\s*(\w+)\]/:/function\s*(\w+)/),c&&2===c.length&&(b=c[1])}return"Object"!==b?b:null}return null},function(){function a(a,b){return function(c,d){if(d.prototype.hasOwnProperty(a)&&delete b[d.prototype[a]],d.prototype[a]=c,c){var e=b[c];if(e&&e!==d){var f="A Class already exists with the same "+a+' : "'+c+'".';j.isEditor||(f+=' (This may be caused by error of unit test.) If you dont need serialization, you can set class id to "". You can also call Fire.unregisterClass to remove the id of unused class'),j.error(f)}else b[c]=d}}}var b={},c={};j._setClassId=a("__cid__",b);var d=a("__classname__",c);j.setClassName=function(a,b){d(a,b),a&&!b.prototype.hasOwnProperty("__cid__")&&j._setClassId(a,b)},j.unregisterClass=function(a){"use strict";for(var d=0;d<arguments.length;d++){var e=arguments[d].prototype,f=e.__cid__;f&&delete b[f];var g=e.__classname__;g&&delete c[g]}},j._getClassById=function(a){return b[a]},j.getClassByName=function(a){return c[a]},j._getClassId=function(a){return"function"==typeof a&&a.prototype.__cid__?a.prototype.__cid__:a&&a.constructor&&a.constructor.prototype&&a.constructor.prototype.hasOwnProperty("__cid__")?a.__cid__:""},Object.defineProperty(j,"_registeredClassIds",{get:function(){var a={};for(var c in b)a[c]=b[c];return a},set:function(a){j.JS.clear(b);for(var c in a)b[c]=a[c]}}),Object.defineProperty(j,"_registeredClassNames",{get:function(){var a={};for(var b in c)a[b]=c[b];return a},set:function(a){j.JS.clear(c);for(var b in a)c[b]=a[b]}})}(),j.log=function(){console.log.apply(console,arguments)},j.info=function(){(console.info||console.log).apply(console,arguments)},j.warn=function(){console.warn.apply(console,arguments)},j.error=console.error.bind?console.error.bind(console):function(){console.error.apply(console,arguments)},function(){var a=Math.PI/180,b=180/Math.PI;j.mixin(Math,{TWO_PI:2*Math.PI,HALF_PI:.5*Math.PI,deg2rad:function(b){return b*a},rad2deg:function(a){return a*b},rad180:function(a){return(a>Math.PI||a<-Math.PI)&&(a=(a+Math.TOW_PI)%Math.TOW_PI),a},rad360:function(a){return a>Math.TWO_PI?a%Math.TOW_PI:0>a?Math.TOW_PI+a%Math.TOW_PI:a},deg180:function(a){return(a>180||-180>a)&&(a=(a+360)%360),a},deg360:function(a){return a>360?a%360:0>a?360+a%360:a},randomRange:function(a,b){return Math.random()*(b-a)+a},randomRangeInt:function(a,b){return Math.floor(this.randomRange(a,b))},clamp:function(a,b,c){return b="undefined"==typeof b?0:b,c="undefined"==typeof c?1:c,Math.min(Math.max(a,b),c)},calculateMaxRect:function(a,b,c,d,e){var f=Math.min(b.x,c.x,d.x,e.x),g=Math.max(b.x,c.x,d.x,e.x),h=Math.min(b.y,c.y,d.y,e.y),i=Math.max(b.y,c.y,d.y,e.y);return a.x=f,a.y=h,a.width=g-f,a.height=i-h,a}})}(),j.Intersection=function(){function a(a,b,c,d){var e,f=(d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x),g=(b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x),h=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!==h){var i=f/h,j=g/h;if(i>=0&&1>=i&&j>=0&&1>=j)return!0}return!1}function b(b,c,d){var e=new j.Vec2(d.x,d.y),f=new j.Vec2(d.x,d.yMax),g=new j.Vec2(d.xMax,d.yMax),h=new j.Vec2(d.xMax,d.y);return a(b,c,e,f)?!0:a(b,c,f,g)?!0:a(b,c,g,h)?!0:a(b,c,h,e)?!0:!1}function c(b,c,d){for(var e=d.points.length,f=0;e>f;++f){var g=d.points[f],h=d.points[(f+1)%e];if(a(b,c,g,h))return!0}return!1}function d(a,b){var c=a.x,d=a.y,e=a.x+a.width,f=a.y+a.height,g=b.x,h=b.y,i=b.x+b.width,j=b.y+b.height;return i>=c&&e>=g&&j>=d&&f>=h}function e(a,b){var d,e=new j.Vec2(a.x,a.y),f=new j.Vec2(a.x,a.yMax),g=new j.Vec2(a.xMax,a.yMax),h=new j.Vec2(a.xMax,a.y);if(c(e,f,b))return!0;if(c(f,g,b))return!0;if(c(g,h,b))return!0;if(c(h,e,b))return!0;for(d=0;d<b.points.length;++d)if(a.contains(b.points[d]))return!0;return b.contains(e)?!0:b.contains(f)?!0:b.contains(g)?!0:b.contains(h)?!0:!1}function f(a,b){var d;for(d=0;d<length;++d){var e=a.points[d],f=a.points[(d+1)%length];if(c(e,f,b))return!0}for(d=0;d<b.points.length;++d)if(a.contains(b.points[d]))return!0;for(d=0;d<a.points.length;++d)if(b.contains(a.points[d]))return!0;return!1}var g={};return g.lineLine=a,g.lineRect=b,g.linePolygon=c,g.rectRect=d,g.rectPolygon=e,g.polygonPolygon=f,g}(),function(){var a=function(){this._callbackTable={}};j._CallbacksHandler=a,a.prototype.add=function(a,b){var c=this._callbackTable[a];return"undefined"!=typeof c?(b&&(null!==c?c.push(b):(c=[b],this._callbackTable[a]=c)),!1):(c=b?[b]:null,this._callbackTable[a]=c,!0)},a.prototype.has=function(a,b){var c=this._callbackTable[a];return c&&c.length>0?b?-1!==c.indexOf(b):!0:!1},a.prototype.removeAll=function(a){delete this._callbackTable[a]},a.prototype.remove=function(a,b){var c=this._callbackTable[a];if(c){var d=c.indexOf(b);if(-1!==d)return c.splice(d,1),!0}return!1};var b=function(){this._callbackTable={}};return j.extend(b,a),j.CallbacksInvoker=b,b.prototype.invoke=function(a,b,c,d,e,f){var g=this._callbackTable[a];if(g)for(var h=0;h<g.length;h++)g[h](b,c,d,e,f)},b.prototype.invokeAndRemove=function(a,b,c,d,e,f){var g=this._callbackTable[a];if(g)for(var h=0;h<g.length;h++)g[h](b,c,d,e,f);this.removeAll(a)},b.prototype.bindKey=function(a,b){var c=this;return function d(e,f,g,h,i){var j=c._callbackTable[a];if(j)for(var k=0;k<j.length;k++)j[k](e,f,g,h,i);b&&c.removeAll(a)}},b}(),j.padLeft=function(a,b,c){return a=a.toString(),b-=a.length,b>0?new Array(b+1).join(c)+a:a},j.getEnumList=function(a){if(void 0!==a.__enums__)return a.__enums__;var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d=parseInt(c);isNaN(d)&&b.push({name:a[a[c]],value:a[c]})}return b.sort(function(a,b){return a.value-b.value}),a.__enums__=b,a.__enums__},j.getVarFrom=function(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;++e){var f=c[e];if(d=d[f],void 0===d||null===d)return null}return d},j.rgb2hsv=function(a,b,c){var d={h:0,s:0,v:0},e=Math.max(a,b,c),f=Math.min(a,b,c),g=0;return d.v=e,d.s=e?(e-f)/e:0,d.s?(g=e-f,d.h=a===e?(b-c)/g:b===e?2+(c-a)/g:4+(a-b)/g,d.h/=6,d.h<0&&(d.h+=1)):d.h=0,d},j.hsv2rgb=function(a,b,c){var d={r:0,g:0,b:0};if(0===b)d.r=d.g=d.b=c;else if(0===c)d.r=d.g=d.b=0;else{1===a&&(a=0),a*=6,b=b,c=c;var e=Math.floor(a),f=a-e,g=c*(1-b),h=c*(1-b*f),i=c*(1-b*(1-f));switch(e){case 0:d.r=c,d.g=i,d.b=g;break;case 1:d.r=h,d.g=c,d.b=g;break;case 2:d.r=g,d.g=c,d.b=i;break;case 3:d.r=g,d.g=h,d.b=c;break;case 4:d.r=i,d.g=g,d.b=c;break;case 5:d.r=c,d.g=g,d.b=h}}return d};var s=function(a){if(a.constructor!=={}.constructor)return!1;for(var b in a)return!1;return!0},t=function(a){return a&&"function"==typeof a.clone&&(a.constructor.prototype.hasOwnProperty("clone")||a.hasOwnProperty("clone"))};j.attr=function(a,b,c){var d="_attr$"+b,e,f,g;if("function"==typeof a){if(e=a.prototype,f=e[d],"undefined"!=typeof c){if("object"!=typeof c)return e[d]=c,c;f||(e[d]=f={});for(g in c)"_"!==g[0]&&(f[g]=c[g])}return f}if(e=a,"undefined"!=typeof c){if("object"==typeof c){e.hasOwnProperty(d)&&(f=e[d]),f||(e[d]=f={});for(g in c)"_"!==g[0]&&(f[g]=c[g]);return j.addon({},f,e.constructor.prototype[d])}return e[d]=c,c}return f=e[d],"object"==typeof f?j.addon({},f,e.constructor.prototype[d]):f},j.NonSerialized={serializable:!1,_canUsedInGetter:!1},j.EditorOnly={editorOnly:!0,_canUsedInGetter:!1},j.Integer={type:"int"},j.Float={type:"float"},j.SingleText={textMode:"single"},j.MultiText={textMode:"multi"},j.Boolean={type:"boolean",_onAfterProp:d("boolean","Fire.Boolean")},j.String={type:"string",_onAfterProp:d("string","Fire.String")},j.ObjectType=function(a){return{type:"object",ctor:a}},j.Enum=function(a){return{type:"enum",enumList:j.getEnumList(a)}},j.EnumList=function(a){return{type:"enum",enumList:a}},j.RawType=function(a){var b=["image","json","text","audio"];return{type:"raw",rawType:a,serializable:!1,hideInInspector:!0,_canUsedInGetter:!1,_onAfterProp:function(a,c){var d=function g(a){if(!j.isChildClassOf(a,C))return j.error("RawType is only available for Assets"),!1;for(var b=!1,c=0;c<a.__props__.length;c++){var d=a.__props__[c],e=j.attr(a,d),f=e.type;if("raw"===f){var g=e.rawType.toLowerCase()!==e.rawType;if(g)return j.error("RawType name cannot contain uppercase"),!1;if(b)return j.error("Each asset cannot have more than one RawType"),!1;b=!0}}return!0}(a);if(d){var e=j.attr(a,c)||{},f=-1!==b.indexOf(e.rawType);f&&a.prop("_rawext","",j.HideInInspector)}}}},j.Custom=function(a){return{custom:a}},j.HideInInspector={hideInInspector:!0},j.DisplayName=function(a){return{displayName:a}},j.ReadOnly={readOnly:!0},j.Tooltip=function(a){return{tooltip:a}},j.Nullable=function(a,b){return{nullable:a,_onAfterProp:function(c,d){c.prop(a,b,j.HideInInspector);var e=j.attr(c,d)||{};e.serializable===!1?j.attr(c,a,j.NonSerialized):e.editorOnly&&j.attr(c,a,j.EditorOnly)}}},j.Watch=function(a,b){return{watch:[].concat(a),watchCallback:b}},j.Range=function(a,b){return{min:a,max:b}};var u=function(a){var b=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/;if(!b.test(a))return void j.error('The property name "'+a+'" is not compliant with JavaScript naming standards');if(this.__props__){var c=this.__props__.indexOf(a);0>c&&this.__props__.push(a)}else this.__props__=[a]},v={__props__:null,prop:function(a,b,c){"use strict";if("object"==typeof b&&b)if(Array.isArray(b)){if(b.length>0)return j.error("Default array must be empty, set default value of "+j.getClassName(this)+'.prop("'+a+'", ...) to null or [], and initialize in constructor please. (just like "this.'+a+' = [...];")'),this}else if(!s(b)&&!t(b))return j.error('Do not set default value to non-empty object, unless the object defines its own "clone" function. Set default value of '+j.getClassName(this)+'.prop("'+a+'", ...) to null or {}, and initialize in constructor please. (just like "this.'+a+' = {foo: bar};")'),this;for(var d=this.$super;d;d=d.$super)if(d.prototype.hasOwnProperty(a))return void j.error("Can not declare "+j.getClassName(this)+"."+a+", it is already defined in the prototype of "+j.getClassName(d));if(j.attr(this,a,{"default":b}),u.call(this,a),c){for(var e=null,f=2,g=f;g<arguments.length;g++){var h=arguments[g];j.attr(this,a,h),h._onAfterProp&&(e=e||[],e.push(h._onAfterProp))}if(e)for(var i=0;i<e.length;i++)e[i](this,a)}return this},get:function(a,b,c){"use strict";var d=Object.getOwnPropertyDescriptor(this.prototype,a);if(d&&d.get)return j.error(j.getClassName(this)+': the getter of "'+a+'" is already defined!'),this;var e=!0;if(c)for(var f=2,g=f;g<arguments.length;g++){var h=arguments[g];if(h._canUsedInGetter!==!1){if(j.attr(this,a,h),h.hideInInspector&&(e=!1),(h.serializable===!1||h.editorOnly===!0)&&j.warn("No need to use Fire.NonSerialized or Fire.EditorOnly for the getter of "+j.getClassName(this)+"."+a+", every getter is actually non-serialized."),h.hasOwnProperty("default"))return j.error(j.getClassName(this)+": Can not set default value of a getter!"),this}else j.error('Can not apply the specified attribute to the getter of "'+j.getClassName(this)+"."+a+'", attribute index: '+(g-f))}if(j.attr(this,a,j.NonSerialized),e)u.call(this,a);else{var i=this.__props__.indexOf(a);if(i>=0)return j.error(j.getClassName(this)+"."+a+" is already defined!"),this}return Object.defineProperty(this.prototype,a,{get:b,configurable:!0}),j.attr(this,a,{hasGetter:!0}),this},set:function(a,b){var c=Object.getOwnPropertyDescriptor(this.prototype,a);return c&&c.set?(j.error(j.getClassName(this)+': the setter of "'+a+'" is already defined!'),this):(Object.defineProperty(this.prototype,a,{set:function(c){this._observing&&Object.getNotifier(this).notify({type:"update",name:a,oldValue:this[a]}),b.call(this,c)},configurable:!0}),j.attr(this,a,{hasSetter:!0}),j.attr(this,a,{originalSetter:b}),this)},getset:function(a,b,c,d){return this.get(a,b,d),this.set(a,c),this}},w=function(a,b){var c=b.__props__;if(c)for(var d=0;d<c.length;d++){var e=c[d],f=j.attr(b,e);if(f&&f.hasOwnProperty("default")){var g=f["default"];"object"==typeof g&&g&&(g=g.clone?g.clone():Array.isArray(g)?[]:{}),a[e]=g}}};j._isFireClass=function(a){return!!a&&a.prop===v.prop},j.isChildClassOf=function(a,b){if(a&&b){if("function"!=typeof a)return j.warn("[isChildClassOf] subclass should be function type, not",a),!1;if("function"!=typeof b)return j.warn("[isChildClassOf] superclass should be function type, not",b),!1;for(;a&&a.$super;a=a.$super)if(a===b)return!0;if(a===b)return!0;for(var c=Object.getPrototypeOf(a.prototype);c;){if(a=c.constructor,a===b)return!0;c=Object.getPrototypeOf(a.prototype)}}return!1},j.define=function(a,b,c){"use strict";var d=!1;switch(arguments.length){case 2:d=j._isFireClass(b);break;case 3:d=!0}var h;d?h=b:c=b,c&&f(c);var i=e(d,c,h);for(var k in v)Object.defineProperty(i,k,{value:v[k],writable:"__props__"===k,enumerable:"__props__"===k});return d&&(j.extend(i,h),i.$super=h,h.__props__&&(i.__props__=h.__props__.slice())),j.setClassName(a,i),g(i,a),i},j._fastDefine=function(a,b,c){j.setClassName(a,b),b.__props__=c;for(var d=0;d<c.length;d++)j.attr(b,c[d],j.HideInInspector)},j.Path=j.isNode?require("path"):function(){var a;if(j.isWin32){var b=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,c=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/;a=function(a){var d=b.exec(a),e=(d[1]||"")+(d[2]||""),f=d[3]||"",g=c.exec(f),h=g[1],i=g[2],j=g[3];return[e,h,i,j]}}else{var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;a=function(a){return d.exec(a).slice(1)}}return path={basename:function(a){return a.replace(/^.*(\\|\/|\:)/,"")},extname:function(a){return a.substring((~-a.lastIndexOf(".")>>>0)+1)},dirname:function(b){var c=a(b),d=c[0],e=c[1];return d||e?(e&&(e=e.substr(0,e.length-1)),d+e):"."},sep:j.isWin32?"\\":"/"},path}(),j.Path.setExtname=function(a,b){var c=(~-a.lastIndexOf(".")>>>0)+1;return a.substring(0,c)+b},j.Path.setEndWithSep=function(a,b){b="undefined"!=typeof b?b:!0;var c=a[a.length-1],d="\\"===c||"/"===c;return!d&&b?a+=j.Path.sep:d&&!b&&(a=a.substring(0,a.length-1)),a},FObject=function(){function a(){this._name="",this._objFlags=0}j._fastDefine("Fire.FObject",a,["_name","_objFlags"]),j.isValid=function(a){return!(!a||a._objFlags&l)},Object.defineProperty(a,"isValid",{value:function(a){return j.warn("FObject.isValid is deprecated, use Fire.isValid instead please"),j.isValid(a)},enumerable:!1});var b=[];return Object.defineProperty(a,"_deferredDestroy",{value:function(){for(var a=b.length,c=0;a>c;++c){var d=b[c];d._objFlags&l||d._destroyImmediate()}a===b.length?b.length=0:b.splice(0,a)},enumerable:!1}),Object.defineProperty(a.prototype,"name",{get:function(){return this._name},set:function(a){this._name=a},enumerable:!1}),Object.defineProperty(a.prototype,"isValid",{get:function(){return!(this._objFlags&l)}}),a.prototype.destroy=function(){return this._objFlags&l?void j.error("object already destroyed"):this._objFlags&m?!1:(this._objFlags|=m,b.push(this),!0)},a.prototype._destruct=function(){for(var a in this)if(this.hasOwnProperty(a)){var b=typeof this[a];switch(b){case"string":this[a]="";break;case"object":this[a]=null;break;case"function":this[a]=null}}},a.prototype._destroyImmediate=function(){return this._objFlags&l?void j.error("object already destroyed"):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),void(this._objFlags|=l))},a}(),j.FObject=FObject;var x=function(){var a=j.define("Fire.HashObject",j.FObject,function(){FObject.call(this),Object.defineProperty(this,"_hashCode",{value:0,writable:!0,enumerable:!1}),Object.defineProperty(this,"_id",{value:"",writable:!0,enumerable:!1})}),b=0;return Object.defineProperty(a.prototype,"hashCode",{get:function(){return this._hashCode||(this._hashCode=++b)}}),Object.defineProperty(a.prototype,"id",{get:function(){return this._id||(this._id=""+this.hashCode)}}),a}();j.HashObject=x,Vec2=function(){function a(a,b){this.x="number"==typeof a?a:0,this.y="number"==typeof b?b:0}return j.setClassName("Fire.Vec2",a),Object.defineProperty(a,"one",{get:function(){return new a(1,1)}}),Object.defineProperty(a,"zero",{get:function(){return new a(0,0)}}),a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.set=function(a){this.x=a.x,this.y=a.y},a.prototype.equals=function(a){return a&&a.constructor===j.Vec2?this.x===a.x&&this.y===a.y:!1},a.prototype.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},a.prototype.addSelf=function(a){return this.x+=a.x,this.y+=a.y,this},a.prototype.add=function(b,c){return c=c||new a,c.x=this.x+b.x,c.y=this.y+b.y,c},a.prototype.subSelf=function(a){return this.x-=a.x,this.y-=a.y,this},a.prototype.sub=function(b,c){return c=c||new a,c.x=this.x-b.x,c.y=this.y-b.y,c},a.prototype.mulSelf=function(a){return this.x*=a,this.y*=a,this},a.prototype.mul=function(b,c){return c=c||new a,c.x=this.x*b,c.y=this.y*b,c},a.prototype.scaleSelf=function(a){return this.x*=a.x,this.y*=a.y,this},a.prototype.scale=function(b,c){return c=c||new a,c.x=this.x*b.x,c.y=this.y*b.y,c},a.prototype.divSelf=function(a){return this.x/=a.x,this.y/=a.y,this},a.prototype.div=function(b,c){return c=c||new a,c.x=this.x/b.x,c.y=this.y/b.y,c},a.prototype.negSelf=function(){return this.x=-this.x,this.y=-this.y,this},a.prototype.neg=function(b){return b=b||new a,b.x=-this.x,b.y=-this.y,b},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y},a.prototype.cross=function(a){return this.y*a.x-this.x*a.y},a.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},a.prototype.magSqr=function(){return this.x*this.x+this.y*this.y},a.prototype.normalizeSelf=function(){var a=this.x*this.x+this.y*this.y;if(1===a)return this;if(0===a)return console.warn("Can't normalize zero vector"),this;var b=1/Math.sqrt(a);return this.x*=b,this.y*=b,this},a.prototype.normalize=function(b){return b=b||new a,b.x=this.x,b.y=this.y,b.normalizeSelf(),b},a.prototype.angle=function(a){var b=this.magSqr(),c=a.magSqr();if(0===b||0===c)return console.warn("Can't get angle between zero vector"),0;var d=this.dot(a),e=d/Math.sqrt(b*c);return e=Math.clamp(e,-1,1),Math.acos(e)},a.prototype.signAngle=function(a){return Math.atan2(this.y,this.x)-Math.atan2(a.y,a.x)},a.prototype.rotate=function(b,c){return c=c||new a,c.x=this.x,c.y=this.y,c.rotateSelf(b)},a.prototype.rotateSelf=function(a){var b=Math.sin(a),c=Math.cos(a),d=this.x;return this.x=c*d-b*this.y,this.y=b*d+c*this.y,this},a}(),j.Vec2=Vec2,j.v2=function Y(a,b){return Array.isArray(a)?new Vec2(a[0],a[1]):new Vec2(a,b)};var y=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};j.setClassName("Fire.Matrix23",y),j.Matrix23=y,y.identity=new y,y.prototype.clone=function(){var a=new y;return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},y.prototype.set=function(a){this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.tx=a.tx,this.ty=a.ty},y.prototype.equals=function(a){return this.a===a.a&&this.b===a.b&&this.c===a.c&&this.d===a.d&&this.tx===a.tx&&this.ty===a.ty},y.prototype.toString=function(){return"|"+this.a.toFixed(2)+" "+this.c.toFixed(2)+" "+this.tx.toFixed(2)+"|\n|"+this.b.toFixed(2)+" "+this.d.toFixed(2)+" "+this.ty.toFixed(2)+"|\n|0.00 0.00 1.00|"},y.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},y.prototype.prepend=function(a){var b=a.a,c=a.b,d=a.c,e=a.d;if(1!==b||0!==c||0!==d||1!==e){var f=this.a,g=this.c;this.a=f*b+this.b*d,this.b=f*c+this.b*e,this.c=g*b+this.d*d,this.d=g*c+this.d*e;var h=this.tx;this.tx=h*b+this.ty*d+a.tx,this.ty=h*c+this.ty*e+a.ty}else this.tx+=a.tx,this.ty+=a.ty;return this},y.prototype.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=1/(a*d-b*c);return this.a=d*f,this.b=-b*f,this.c=-c*f,this.d=a*f,this.tx=(c*this.ty-d*e)*f,this.ty=(b*e-a*this.ty)*f,this},y.prototype.transformPoint=function(a,b){b=b||new Vec2;var c=a.x;return b.x=this.a*c+this.c*a.y+this.tx,b.y=this.b*c+this.d*a.y+this.ty,b},y.prototype.getScale=function(a){return a=a||new Vec2,a.x=Math.sqrt(this.a*this.a+this.b*this.b),a.y=Math.sqrt(this.c*this.c+this.d*this.d),a},y.prototype.setScale=function(a){var b=this.getScale(),c=a.x/b.x,d=a.y/b.y;return this.a*=c,this.b*=c,this.c*=d,this.d*=d,this},y.prototype.getRotation=function(){var a=this.b/this.a!==-this.c/this.d;return a?.5*(Math.atan2(this.b,this.a)+Math.atan2(-this.c,this.d)):Math.atan2(-this.c,this.d)},y.prototype.getTranslation=function(a){return a=a||new Vec2,a.x=this.tx,a.y=this.ty,a},y.prototype.rotate=function(a){var b=Math.sin(a),c=Math.cos(a),d=this.a,e=this.b;return this.a=d*c+this.c*b,this.b=e*c+this.d*b,this.c=this.c*c-d*b,this.d=this.d*c-e*b,this};var z=function(){function a(a,b,c,d){this.x="number"==typeof a?a:0,this.y="number"==typeof b?b:0,this.width="number"==typeof c?c:0,this.height="number"==typeof d?d:0}return j.setClassName("Fire.Rect",a),a.fromVec2=function(b,c){var d=Math.min(b.x,c.x),e=Math.min(b.y,c.y),f=Math.max(b.x,c.x),g=Math.max(b.y,c.y);return new a(d,e,f-d,g-e)},a.contain=function b(a,c){return a.x<=c.x&&a.x+a.width>=c.x+c.width&&a.y<=c.y&&a.y+a.height>=c.y+c.height?1:c.x<=a.x&&c.x+c.width>=a.x+a.width&&c.y<=a.y&&c.y+c.height>=a.y+a.height?-1:0},a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)},a.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height},a.prototype.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},Object.defineProperty(a.prototype,"xMax",{get:function(){return this.x+this.width}}),Object.defineProperty(a.prototype,"yMax",{get:function(){return this.y+this.height}}),Object.defineProperty(a.prototype,"center",{get:function(){return new j.Vec2(this.x+.5*this.width,this.y+.5*this.height)}}),a.prototype.intersects=function(a){return j.Intersection.rectRect(this,a)},a.prototype.contains=function(a){return this.x<=a.x&&this.x+this.width>=a.x&&this.y<=a.y&&this.y+this.height>=a.y?!0:!1},a.prototype.containsRect=function(a){return this.x<=a.x&&this.x+this.width>=a.x+a.width&&this.y<=a.y&&this.y+this.height>=a.y+a.height?!0:!1},a}();j.Rect=z,j.rect=function Z(a,b,c,d){return Array.isArray(a)?new z(a[0],a[1],a[2],a[3]):new z(a,b,c,d)},j.Polygon=function(){function a(a){this.points=a,this.points.length<3&&console.warn("Invalid polygon, the data must contains 3 or more points.")}return j.setClassName("Fire.Polygon",a),a.prototype.intersects=function(a){return Intersection.polygonPolygon(this,a)},a.prototype.contains=function(a){for(var b=!1,c=a.x,d=a.y,e=this.points.length,f=0,g=e-1;e>f;g=f++){var h=this.points[f].x,i=this.points[f].y,j=this.points[g].x,k=this.points[g].y,l=i>d!=k>d&&(j-h)*(d-i)/(k-i)+h>c;l&&(b=!b)}return b},Object.defineProperty(a.prototype,"center",{get:function(){if(this.points.length<3)return null;for(var a=this.points[0].x,b=this.points[0].y,c=this.points[0].x,d=this.points[0].y,e=1;e<this.points.length;++e){var f=this.points[e].x,g=this.points[e].y;a>f?a=f:f>c&&(c=f),b>g?b=g:g>d&&(d=g)}return new j.Vec2(.5*(c+a),.5*(d+b))}}),a}();var A=function(){function a(a,b,c,d){this.r="number"==typeof a?a:0,this.g="number"==typeof b?b:0,this.b="number"==typeof c?c:0,this.a="number"==typeof d?d:1}return j.setClassName("Fire.Color",a),a.prototype.clone=function(){return new a(this.r,this.g,this.b,this.a)},a.prototype.equals=function(a){return this.r===a.r&&this.g===a.g&&this.b===a.b&&this.a===a.a},a.prototype.toString=function(){return"rgba("+this.r.toFixed(2)+", "+this.g.toFixed(2)+", "+this.b.toFixed(2)+", "+this.a.toFixed(2)+")"},a.prototype.toCSS=function(a){return"rgba"===a?"rgba("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+","+this.a.toFixed(2)+")":"rgb"===a?"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")":"#"+this.toHEX(a)},a.prototype.equalTo=function(b){return b instanceof a&&this.r===b.r&&this.g===b.g&&this.b===b.b&&this.a===b.a},a.prototype.clamp=function(){this.r=Math.clamp(this.r),this.g=Math.clamp(this.g),this.b=Math.clamp(this.b),this.a=Math.clamp(this.a)},a.prototype.fromHEX=function(a){var b=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return this.r=b>>16,this.g=(65280&b)>>8,this.b=255&b,this},a.prototype.toHEX=function(a){var b=[(255*this.r|0).toString(16),(255*this.g|0).toString(16),(255*this.b|0).toString(16)],c=-1;if("#rgb"===a)for(c=0;c<b.length;++c)b[c].length>1&&(b[c]=b[c][0]);else if("#rrggbb"===a)for(c=0;c<b.length;++c)1===b[c].length&&(b[c]="0"+b[c]);return b.join("")},a.prototype.toRGBValue=function(){return(255*this.r<<16)+(255*this.g<<8)+255*this.b},a.prototype.fromHSV=function(a,b,c){var d=j.hsv2rgb(a,b,c);return this.r=d.r,this.g=d.g,this.b=d.b,this},a.prototype.toHSV=function(){return j.rgb2hsv(this.r,this.g,this.b)},a}();j.Color=A,j.color=function $(a,b,c,d){return Array.isArray(a)?new A(a[0],a[1],a[2],a[3]):new A(a,b,c,d)};var B=function(){function a(a,b,c,f,g){if(this._editor=f,this._classFinder=g,this._target=c,this._idList=[],this._idObjList=[],this._idPropList=[],this.result=b||new j._DeserializeInfo,Array.isArray(a)){var h=a,i=h.length;this.deserializedList=new Array(i);for(var k=0;i>k;k++)if(h[k]){var l;l=0===k&&c,this.deserializedList[k]=e(this,h[k],l)}this.deserializedData=i>0?this.deserializedList[0]:[]}else this.deserializedList=[null],this.deserializedData=a?e(this,a,c):null,this.deserializedList[0]=this.deserializedData;d(this)}function b(a,b,c,d,f){var g=c.__id__;if("undefined"==typeof g){var h=c.__uuid__;if(h){if(f&&f[d]&&f[d]._uuid===h)return;a.result.uuidList.push(h),a.result.uuidObjList.push(b),a.result.uuidPropList.push(d)}else b[d]=e(a,c,f&&f[d])}else{var i=a.deserializedList[g];i?b[d]=i:(a._idList.push(g),a._idObjList.push(b),a._idPropList.push(d))}}function c(a,c,d){for(var f in c){var g=d[f];"undefined"!=typeof g&&d.hasOwnProperty(f)&&("object"!=typeof g?c[f]=g:g?g.__uuid__||"undefined"!=typeof g.__id__?b(a,c,g,f,a._target&&c):c[f]=e(a,g,a._target&&c[f]):c[f]=null)}}var d=function(a){for(var b=a.deserializedList,c=0,d=a._idList.length;d>c;c++){var e=a._idPropList[c],f=a._idList[c];a._idObjList[c][e]=b[f]}},e=function(a,d,f){var g,h,i=null,k=null;if(d.__type__){if(k=a._classFinder(d.__type__),!k)return j.error("[Fire.deserialize] unknown type: "+d.__type__),null;f?(f instanceof k||j.warn("Type of target to deserialize not matched with data: target is %s, data is %s",j.getClassName(f),k),i=f):i=new k}else{if(Array.isArray(d)){f?(f.length=d.length,i=f):i=d;for(var l=0;l<d.length;l++)h=d[l],"object"==typeof h&&h?h.__uuid__||"undefined"!=typeof h.__id__?b(a,i,h,""+l,f&&f[l]):i[l]=e(a,h,f&&f[l]):f&&(i[l]=d[l]);return i}i=f||d}if(k&&j._isFireClass(k)){var m=k.__props__;if(!m)return i;for(var n=0;n<m.length;n++){g=m[n];var o=j.attr(k,g),p=o.rawType;if(p)a.result.rawProp&&j.error("not support multi raw object in a file"),a.result.rawProp=g;else{if(o.serializable===!1)continue;if(!a._editor&&o.editorOnly)continue;h=d[g],"undefined"!=typeof h&&("object"!=typeof h?i[g]=h:h?h.__uuid__||"undefined"!=typeof h.__id__?b(a,i,h,g,f&&i):i[g]=e(a,h,f&&f[g]):i[g]=null)}}"_$erialized"===m[m.length-1]&&(i._$erialized=d,c(a,i._$erialized,d))}else c(a,i,d);return i};return a}();j.deserialize=function(a,b,c){var d=c&&"isEditor"in c?c.isEditor:j.isEditor,e=c&&c.classFinder||j._getClassById,f=c&&c.createAssetRefs||j.isEditorCore,g;g=c&&c.target,j.isNode&&Buffer.isBuffer(a)&&(a=a.toString()),"string"==typeof a&&(a=JSON.parse(a)),f&&!b&&(b=new j._DeserializeInfo),j._isCloning=!0;var h=new B(a,b,g,d,e);return j._isCloning=!1,f&&b.assignAssetsBy(j.serialize.asAsset),h.deserializedData},j._DeserializeInfo=function(){this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.rawProp=""},j._DeserializeInfo.prototype.reset=function(){this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp=""},j._DeserializeInfo.prototype.getUuidOf=function(a,b){for(var c=0;c<this.uuidObjList.length;c++)if(this.uuidObjList[c]===a&&this.uuidPropList[c]===b)return this.uuidList[c];return""},j._DeserializeInfo.prototype.assignAssetsBy=function(a){for(var b=0,c=this.uuidList.length;c>b;b++){var d=this.uuidList[b],e=a(d);if(e){var f=this.uuidObjList[b],g=this.uuidPropList[b];f[g]=e}else j.error("Failed to assign asset: "+d)}},j.instantiate=function(a){if("object"!=typeof a||Array.isArray(a))return j.error("The thing you want to instantiate must be an object"),null;if(!a)return j.error("The thing you want to instantiate is nil"),null;
if(a instanceof j.FObject&&!a.isValid)return j.error("The thing you want to instantiate is destroyed"),null;var b;return a._instantiate?(j._isCloning=!0,b=a._instantiate(),j._isCloning=!1,b):a instanceof j.Asset?(j.error("The instantiate method for given asset do not implemented"),null):(j._isCloning=!0,b=j._doInstantiate(a),j._isCloning=!1,b)},j._doInstantiate=function(){function a(a){if(Array.isArray(a))return j.error("Can not instantiate array"),null;if(c(a))return j.error("Can not instantiate DOM element"),null;for(var b=e(a),f=0,g=d.length;g>f;++f)d[f]._iN$t=null;return d.length=0,b}function b(a){var f=a._iN$t;if(f)return f;if(a instanceof C)return a;if(Array.isArray(a)){var g=a.length;f=new Array(g),a._iN$t=f;for(var h=0;g>h;++h){var i=a[h],j=typeof i;f[h]="object"===j?i?b(i):i:"function"!==j?i:null}return d.push(a),f}return c(a)?null:e(a)}var d=[],e=function(a){var c,e,f=a.constructor,g=new f;if(a._iN$t=g,d.push(a),j._isFireClass(f)){var h=f.__props__;if(h)for(var i=0;i<h.length;i++){var k=h[i],l=j.attr(f,k);l.serializable!==!1&&(c=a[k],e=typeof c,g[k]="object"===e?c?b(c):c:"function"!==e?c:null)}}else for(var m in a)a.hasOwnProperty(m)===!1||95===m.charCodeAt(0)&&95===m.charCodeAt(1)||(c=a[m],c!==g&&(e=typeof c,g[m]="object"===e?c?b(c):c:"function"!==e?c:null));return a instanceof FObject&&(g._objFlags&=r),g};return a}(),j._isCloning=!1;var C=function(){var a=j.define("Fire.Asset",j.HashObject,function(){j.HashObject.call(this),Object.defineProperty(this,"_uuid",{value:"",writable:!0,enumerable:!1})});return a.prototype._setRawExtname=function(a){this.hasOwnProperty("_rawext")?("."===a.charAt(0)&&(a=a.substring(1)),this._rawext=a):j.error("Have not defined any RawTypes yet, no need to set raw file's extname.")},a}();j.Asset=C;var D=function(){var a=j.define("Fire.CustomAsset",j.Asset);return a}();j.CustomAsset=D,j.addCustomAssetMenu=j.addCustomAssetMenu||function(a,b,c){},j.Texture=function(){var a=j.define("Fire.Texture",j.Asset,function(){a.$super.call(this);var b=arguments[0];b&&(this.image=b,this.width=b.width,this.height=b.height)});return a.WrapMode=function(a){return a[a.Repeat=0]="Repeat",a[a.Clamp=1]="Clamp",a}({}),a.FilterMode=function(a){return a[a.Point=0]="Point",a[a.Bilinear=1]="Bilinear",a[a.Trilinear=2]="Trilinear",a}({}),a.prop("image",null,j.RawType("image")),a.prop("width",0,j.Integer),a.prop("height",0,j.Integer),a.prop("wrapMode",a.WrapMode.Clamp,j.Enum(a.WrapMode)),a.prop("filterMode",a.FilterMode.Bilinear,j.Enum(a.FilterMode)),a}(),j.Sprite=function(){var a=j.define("Fire.Sprite",j.Asset,function(){a.$super.call(this);var b=arguments[0];b&&(this.texture=new j.Texture(b),this.width=b.width,this.height=b.height)});return a.prop("pivot",new j.Vec2(.5,.5),j.Tooltip("The pivot is normalized, like a percentage.\n(0,0) means the bottom-left corner and (1,1) means the top-right corner.\nBut you can use values higher than (1,1) and lower than (0,0) too.")),a.prop("trimX",0,j.Integer),a.prop("trimY",0,j.Integer),a.prop("width",0,j.Integer),a.prop("height",0,j.Integer),a.prop("texture",null,j.ObjectType(j.Texture),j.HideInInspector),a.prop("rotated",!1,j.HideInInspector),a.prop("x",0,j.Integer,j.HideInInspector),a.prop("y",0,j.Integer,j.HideInInspector),a.prop("rawWidth",0,j.Integer,j.HideInInspector),a.prop("rawHeight",0,j.Integer,j.HideInInspector),Object.defineProperty(a.prototype,"rotatedWidth",{get:function(){return this.rotated?this.height:this.width}}),Object.defineProperty(a.prototype,"rotatedHeight",{get:function(){return this.rotated?this.width:this.height}}),a}(),j.Atlas=function(){var a=j.define("Fire.Atlas",j.Asset,null);return a.Algorithm=function(a){return a[a.Basic=0]="Basic",a[a.Tree=1]="Tree",a[a.MaxRect=2]="MaxRect",a}({}),a.SortBy=function(a){return a[a.UseBest=0]="UseBest",a[a.Width=1]="Width",a[a.Height=2]="Height",a[a.Area=3]="Area",a[a.Name=4]="Name",a}({}),a.SortOrder=function(a){return a[a.UseBest=0]="UseBest",a[a.Ascending=1]="Ascending",a[a.Descending=2]="Descending",a}({}),a.prop("width",512,j.Integer),a.prop("height",512,j.Integer),a.prop("sprites",[],j.ObjectType(j.Sprite),j.HideInInspector),a.prototype.add=function(a){for(var b=0;b<this.sprites.length;++b){var c=this.sprites[b];if(c._uuid===a._uuid)return!1}return this.sprites.push(a),!0},a.prototype.remove=function(a){for(var b=0;b<this.sprites.length;++b){var c=this.sprites[b];if(c._uuid===a._uuid)return this.sprites.splice(b,1),!0}return!1},a.prototype.clear=function(){this.sprites=[]},a.prototype.layout=function(a){void 0===a.algorithm&&(a.algorithm=j.Atlas.Algorithm.MaxRect),void 0===a.sortBy&&(a.sortBy=j.Atlas.SortBy.UseBest),void 0===a.sortOrder&&(a.sortOrder=j.Atlas.SortOrder.UseBest),void 0===a.allowRotate&&(a.allowRotate=!0),void 0===a.autoSize&&(a.autoSize=!0),void 0===a.padding&&(a.padding=2),j.AtlasUtils.sort(this,a.algorithm,a.sortBy,a.sortOrder,a.allowRotate),j.AtlasUtils.layout(this,a.algorithm,a.autoSize,a.padding,a.allowRotate)},a}();var E={},F=function(a,b){for(var c=0,d=0,e=0,f=0;f<a.sprites.length;++f){var g=a.sprites[f];if(c+g.rotatedWidth>a.width&&(c=0,d=d+e+b,e=0),d+g.rotatedHeight>a.height)throw new Error("Warning: Failed to layout element "+g.name);g.x=c,g.y=d,c=c+g.rotatedWidth+b,g.rotatedHeight>e&&(e=g.rotatedHeight)}},G=function(a,b,c,d){if(null!==a.right){var e=G(a.right,b,c,d);return null!==e?e:G(a.bottom,b,c,d)}var f=b.rotatedWidth,g=b.rotatedHeight,h=f+c,i=g+c,k=a.rect;if(f>k.width||g>k.height){if(d===!1)return null;if(g>k.width||f>k.height)return null;b.rotated=!b.rotated,f=b.rotatedWidth,g=b.rotatedHeight,h=f+c,i=g+c}return a.right={rect:new j.Rect(k.x+h,k.y,k.width-h,g),right:null,bottom:null},a.bottom={rect:new j.Rect(k.x,k.y+i,k.width,k.height-i),right:null,bottom:null},[k.x,k.y]},H=function(a,b,c){for(var d={rect:new j.Rect(0,0,a.width,a.height),right:null,bottom:null},e=0;e<a.sprites.length;++e){var f=a.sprites[e],g=G(d,f,b,c);if(null===g)throw new Error("Warning: Failed to layout element "+f.name);f.x=g[0],f.y=g[1]}},I=function(a,b,c){if(c.x>=b.x+b.width||c.x+c.width<=b.x||c.y>=b.y+b.height||c.y+c.height<=b.y)return!1;var d;return c.x<b.x+b.width&&c.x+c.width>b.x&&(c.y>b.y&&c.y<b.y+b.height&&(d=b.clone(),d.height=c.y-d.y,a.push(d)),c.y+c.height<b.y+b.height&&(d=b.clone(),d.y=c.y+c.height,d.height=b.y+b.height-(c.y+c.height),a.push(d))),c.y<b.y+b.height&&c.y+c.height>b.y&&(c.x>b.x&&c.x<b.x+b.width&&(d=b.clone(),d.width=c.x-d.x,a.push(d)),c.x+c.width<b.x+b.width&&(d=b.clone(),d.x=c.x+c.width,d.width=b.x+b.width-(c.x+c.width),a.push(d))),!0},J=function(a,b){var c;for(c=0;c<a.length;++c)I(a,a[c],b)&&(a.splice(c,1),--c);for(c=0;c<a.length;++c)for(var d=c+1;d<a.length;++d){if(a[d].containsRect(a[c])){a.splice(c,1),--c;break}a[c].containsRect(a[d])&&(a.splice(d,1),--d)}},K=function(a,b,c){var d=[];d.push(new j.Rect(0,0,a.width+b,a.height+b));for(var e,f,g=function(a,b,c,d){e=Number.MAX_VALUE,score2=Number.MAX_VALUE;for(var f=new j.Rect(0,0,1,1),g=!1,h=0;h<a.length;++h){var i=a[h],k,l,m,n;i.width>=b&&i.height>=c&&(k=Math.abs(Math.floor(i.width)-b),l=Math.abs(Math.floor(i.height)-c),m=Math.min(k,l),n=Math.max(k,l),(e>m||m===e&&n<score2)&&(f.x=i.x,f.y=i.y,f.width=b,f.height=c,e=m,score2=n,g=!0)),d&&i.width>=c&&i.height>=b&&(k=Math.abs(Math.floor(i.width)-c),l=Math.abs(Math.floor(i.height)-b),m=Math.min(k,l),n=Math.max(k,l),(e>m||m===e&&n<score2)&&(f.x=i.x,f.y=i.y,f.width=c,f.height=b,e=m,score2=n,g=!0))}return g===!1&&(e=Number.MAX_VALUE,score2=Number.MAX_VALUE),f},h=a.sprites.slice();h.length>0;){for(var i=Number.MAX_VALUE,k=Number.MAX_VALUE,l=-1,m=new j.Rect(0,0,1,1),n=0;n<h.length;++n){var o=g(d,h[n].width+b,h[n].height+b,c);(i>e||e===i&&score2<k)&&(i=e,k=score2,m=o,l=n)}if(-1===l)throw new Error("Error: Failed to layout atlas element");J(d,m);var p=h[l];p.x=Math.floor(m.x),p.y=Math.floor(m.y),p.rotated=p.width+b!==m.width,h.splice(l,1)}};E.layout=function(a,b,c,d,e){try{switch(b){case j.Atlas.Algorithm.Basic:F(a,d);break;case j.Atlas.Algorithm.Tree:H(a,d,e);break;case j.Atlas.Algorithm.MaxRect:K(a,d,e)}}catch(f){if(c===!1)return void j.error(f.message);if(4096===a.width&&4096===a.height)return void j.error(f.message);a.width===a.height?a.width*=2:a.height=a.width,E.layout(a,b,c,d,e)}};var L=function(a,b){var c=a.width-b.width;return 0===c&&(c=a.name.localeCompare(b.name)),c},M=function(a,b){var c=a.height-b.height;return 0===c&&(c=a.name.localeCompare(b.name)),c},N=function(a,b){var c=a.width*a.height-b.width*b.height;return 0===c&&(c=a.name.localeCompare(b.name)),c},O=function(a,b){return a.name.localeCompare(b.name)},P=function(a,b){var c=a.width;a.height>a.width&&(c=a.height,a.rotated=!0);var d=b.width;b.height>b.width&&(d=b.height,b.rotated=!0);var e=c-d;return 0===e&&(e=a.name.localeCompare(b.name)),e},Q=function(a,b){var c=a.height;a.width>a.height&&(c=a.width,a.rotated=!0);var d=b.height;b.width>b.height&&(d=b.width,b.rotated=!0);var e=c-d;return 0===e&&(e=a.name.localeCompare(b.name)),e};E.sort=function(a,b,c,d,e){for(var f=0;f<a.sprites.length;++f){var g=a.sprites[f];g.rotated=!1}var h=c,i=d;if(h===j.Atlas.SortBy.UseBest)switch(b){case j.Atlas.Algorithm.Basic:h=j.Atlas.SortBy.Height;break;case j.Atlas.Algorithm.Tree:h=j.Atlas.SortBy.Area;break;case j.Atlas.Algorithm.MaxRect:h=j.Atlas.SortBy.Area;break;default:h=j.Atlas.SortBy.Height}switch(i===j.Atlas.SortOrder.UseBest&&(i=j.Atlas.SortOrder.Descending),h){case j.Atlas.SortBy.Width:a.sprites.sort(e?P:L);break;case j.Atlas.SortBy.Height:a.sprites.sort(e?Q:M);break;case j.Atlas.SortBy.Area:a.sprites.sort(N);break;case j.Atlas.SortBy.Name:a.sprites.sort(O)}i===j.Atlas.SortOrder.Descending&&a.sprites.reverse()},j.AtlasUtils=E;var R=function(){var a=j.define("Fire.JsonAsset",C).prop("json",null,j.RawType("json"));return a}();j.JsonAsset=R,j.TextAsset=function(){var a=j.define("Fire.TextAsset",j.Asset,function(){j.Asset.call(this)});return a.prop("text","",j.RawType("text")),a}();var S=function(){var a=j.define("Fire.BitmapFont",j.Asset,null);return a.prop("texture",null,j.ObjectType(j.Texture)),a.prop("charInfos",[]),a.prop("kernings",[]),a.prop("baseLine",0,j.Integer),a.prop("lineHeight",0,j.Integer),a.prop("size",0,j.Integer),a.prop("face",null,j.HideInInspector),a}();j.BitmapFont=S;var T=function(){function a(a,b){this._exporting=b,this.serializedList=[],this._parsingObjs=[],this._parsingData=[],this._objsToResetId=[],i(this,a);for(var c=0;c<this._objsToResetId.length;++c)this._objsToResetId[c].__id__=void 0;this._parsingObjs=null,this._parsingData=null,this._objsToResetId=null}var b=function(a,b){var c=a._parsingObjs.indexOf(b),d=-1!==c;if(d){var e=a.serializedList.length;b.__id__=e,a._objsToResetId.push(b);var f=a._parsingData[c];if(Array.isArray(b)===!1){var g=h(b);g&&(f.__type__=g)}return a.serializedList.push(f),f}},d=function(a,b,c){if(Array.isArray(b))for(var f=0;f<b.length;++f){var g=e(a,b[f]);"undefined"!=typeof g&&c.push(g)}else{var h=b.constructor;if(j._isFireClass(h)){var i=h.__props__;if(i)if("_$erialized"!==i[i.length-1])for(var k=0;k<i.length;k++){var l=i[k],m=j.attr(h,l);m.serializable!==!1&&(a._exporting&&m.editorOnly||(c[l]=e(a,b[l])))}else c.__type__=b._$erialized.__type__,d(a,b._$erialized,c)}else for(var n in b)!b.hasOwnProperty(n)||95===n.charCodeAt(0)&&95===n.charCodeAt(1)||(c[n]=e(a,b[n]))}},e=function(a,b){var c=typeof b;if("object"===c){if(b instanceof FObject){var d=b._objFlags;if(d&n)return void 0;if(a._exporting&&d&o)return void 0}return g(a,b)}return"function"!==c?b:null},f=function(a,b){var c;if(Array.isArray(b))c=[];else{c={};var e=h(b);e&&(c.__type__=e)}var f=a.serializedList.length;if(a._parsingObjs.push(b),a._parsingData.push(c),d(a,b,c),a._parsingObjs.pop(),a._parsingData.pop(),a.serializedList.length>f){var g=a.serializedList.indexOf(c,f);if(-1!==g)return{__id__:g}}return c},g=function(a,e){if(!e)return null;var g=e.__id__;if("undefined"!=typeof g)return{__id__:g};if(e instanceof FObject){if(!e.isValid)return null;var i=e._uuid;if(i)return{__uuid__:i};g=a.serializedList.length,e.__id__=g,a._objsToResetId.push(e);var j={};a.serializedList.push(j);var k=h(e);return k&&(j.__type__=k),d(a,e,j),j._objFlags&=r,{__id__:g}}if(c(e))return null;var l=b(a,e);return l?(g=e.__id__,{__id__:g}):f(a,e)},i=function(a,b){if(b instanceof FObject){var e=b._uuid;"undefined"!=typeof e&&(b._uuid=null),g(a,b),"undefined"!=typeof e&&(b._uuid=e)}else if("object"==typeof b&&b){if(c(b))return j.warn(""+b+" won't be serialized"),void a.serializedList.push(null);var f;if(Array.isArray(b))f=[];else{f={};var i=h(b);i&&(f.__type__=i)}b.__id__=0,a._objsToResetId.push(b),a.serializedList.push(f),d(a,b,f)}else a.serializedList.push(g(a,b))};return a}();j.serialize=function(a,b){var c=b&&b.exporting,d=b&&b.network,e=b&&"stringify"in b?b.stringify:!0,f=b&&b.nicify,g=new T(a,c,d),h=g.serializedList;f&&V(h);var i=1===h.length?h[0]:h;return e===!1?i:JSON.stringify(i,null,2)},j.serialize.asAsset=function(a){a||j.error("[Fire.serialize.asAsset] The uuid must be non-nil!");var b=new C;return b._uuid=a,b},j.serialize.setName=function(a,b){Array.isArray(a)?a[0]._name=b:a._name=b};var U=function(){this.objList=[],this.keyList=[],this.referncedIDList=[],this.referencedCounts=[],this.temporaryDataList=[]},V=function(a){var b=a[0];if("undefined"!=typeof b){var c=new U;c.referencedCounts=new Array(a.length);var d,e,f,g,h,i=a.slice();W(b,a,c);var j=0;for(j=0;j<c.temporaryDataList.length;j++)delete c.temporaryDataList[j]._iN$t;for(j=0;j<c.objList.length;j++)if(e=c.objList[j],d=c.referncedIDList[j],f=c.keyList[j],g=i[d],h=c.referencedCounts[d]>1,!h){e[f]=g;var k=a.indexOf(g);a.splice(k,1)}for(j=0;j<c.objList.length;j++)if(d=c.referncedIDList[j],f=c.keyList[j],e=c.objList[j],h=c.referencedCounts[d]>1){g=i[d];var l=a.indexOf(g);e[f].__id__=l}}};j._nicifySerialized=V;var W=function(a,b,c){if("object"==typeof a){var d;if(a._iN$t=!0,c.temporaryDataList.push(a),Array.isArray(a))for(var e=0;e<a.length;e++)d=a[e],d&&X(d,e,a,b,c);else for(var f in a)d=a[f],d&&X(d,f,a,b,c)}},X=function(a,b,c,d,e){var f,g=a.__id__,h="undefined"!=typeof g;h&&(a=d[g],f=-1!==e.referncedIDList.indexOf(g),f?e.referencedCounts[g]++:e.referencedCounts[g]=1,e.referncedIDList.push(g),e.keyList.push(b),e.objList.push(c));var i=!a._iN$t;i?W(a,d,e):h&&e.referencedCounts[g]++};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports.Fire=j):"undefined"!=typeof define&&define.amd?define(j):i.Fire=j}).call(this);