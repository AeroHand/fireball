var Fire=Fire||{};!function(a){function b(a,c){if(a){var d=Object.getOwnPropertyDescriptor(a,c);return d||b(Object.getPrototypeOf(a),c)}}function c(a,c,d){var e=b(c,a);Object.defineProperty(d,a,e)}function d(a){return"object"==typeof Node?a instanceof Node:a&&"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName}function e(b,c){return function(d,e){var f=a.attr(d,e)||{};if(f.type!==b)return void a.warn("Can only indicate one type attribute for %s.%s.",a.getClassName(d),e);if(f.hasOwnProperty("default")){var g=Array.isArray(f["default"])||r(f["default"]);if(!g){var h=typeof f["default"];h===b?a.warn('No needs to indicate the "%s" attribute for %s.%s, which its default value is type of %s.',c,a.getClassName(d),e,b):a.warn('Can not indicate the "%s" attribute for %s.%s, which its default value is type of %s.',c,a.getClassName(d),e,h),delete f.type}}}}function f(a,b,c){var d;return d=b?function(){this._observing=!1,v(this,d),b.apply(this,arguments)}:a?function(){this._observing=!1,v(this,d),c.apply(this,arguments)}:function(){this._observing=!1,v(this,d)}}function g(b){return"function"!=typeof b?void a.error("Constructor of FireClass must be function type"):b.length>0?void a.warn("Can not instantiate FireClass with arguments."):void 0}function h(b,c){c&&(b.toString=function(){var b=Function.toString.call(this);return b.replace("function ","function "+a.getClassName(this))})}function i(a){var b=a.constructor.prototype;return b.hasOwnProperty("__cid__")?a.__cid__:b.hasOwnProperty("__classname__")?a.__classname__:""}if(a._customAssetMenuItems=[],a.addCustomAssetMenu=function(b,c,d){a._customAssetMenuItems.push({customAsset:b,menuPath:c,priority:d}),a.sendToPages&&a.sendToPages("asset:refresh-context-menu")},a.isNode=!("undefined"==typeof process||!process.versions||!process.versions.node),a.isNodeWebkit=!!(a.isNode&&"node-webkit"in process.versions),a.isAtomShell=!!(a.isNode&&"atom-shell"in process.versions),a.isApp=a.isNodeWebkit||a.isAtomShell,a.isPureWeb=!a.isNode&&!a.isApp,a.isEditor=a.isApp,a.isWeb=a.isAtomShell?"undefined"!=typeof process&&"renderer"===process.type:"undefined"==typeof __dirname||null===__dirname,a.isEditorCore=a.isApp&&!a.isWeb,Object.defineProperty(a,"isRetina",{get:function(){return a.isWeb&&window.devicePixelRatio&&window.devicePixelRatio>1}}),a.isNode)a.isDarwin="darwin"===process.platform,a.isWin32="win32"===process.platform;else{var j=window.navigator.platform;a.isDarwin="Mac"===j.substring(0,3),a.isWin32="Win"===j.substring(0,3)}var k=1,l=2,m=4,n=8,o=16,p={DontSave:m,EditorOnly:n,Dirty:o,Destroying:512,HideInGame:1024,HideInEditor:2048,IsOnEnableCalled:4096,IsOnLoadCalled:8192,IsOnStartCalled:16384};p.Hide=p.HideInGame|p.HideInEditor,a._ObjectFlags=p;var q=~(l|o|p.Destroying|p.IsOnEnableCalled|p.IsOnLoadCalled|p.IsOnStartCalled);a.JS={clear:function(a){for(var b=Object.keys(a),c=0;c<b.length;c++)delete a[b[c]]}},a.addon=function(a){"use strict";a=a||{};for(var b=1,d=arguments.length;d>b;b++){var e=arguments[b];for(var f in e)void 0===a[f]&&c(f,e,a)}return a},a.mixin=function(b){"use strict";b=b||{};for(var d=1,e=arguments.length;e>d;d++){var f=arguments[d];if(f){if("object"!=typeof f){a.error("Fire.mixin called on non-object:",f);continue}for(var g in f)c(g,f,b)}}return b},a.extend=function(b,c){function d(){this.constructor=b}if(!c)return void a.error("The base class to extend from must be non-nil");if(!b)return void a.error("The class to extend must be non-nil");for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b},a.getClassName=function(a){if("function"==typeof a&&a.prototype.__classname__)return a.prototype.__classname__;if(a&&a.constructor){if(a.constructor.prototype&&a.constructor.prototype.hasOwnProperty("__classname__"))return a.__classname__;var b;if(a.constructor.name&&(b=a.constructor.name),a.constructor.toString){var c,d=a.constructor.toString();c=d.match("["===d.charAt(0)?/\[\w+\s*(\w+)\]/:/function\s*(\w+)/),c&&2===c.length&&(b=c[1])}return"Object"!==b?b:null}return null},function(){function b(b,c){return function(d,e){if(e.prototype.hasOwnProperty(b)&&delete c[e.prototype[b]],e.prototype[b]=d,d){var f=c[d];if(f&&f!==e){var g="A Class already exists with the same "+b+' : "'+d+'".';a.isEditor||(g+=' (This may be caused by error of unit test.) If you dont need serialization, you can set class id to "". You can also call Fire.unregisterClass to remove the id of unused class'),a.error(g)}else c[d]=e}}}var c={},d={};a._setClassId=b("__cid__",c);var e=b("__classname__",d);a.setClassName=function(b,c){e(b,c),b&&!c.prototype.hasOwnProperty("__cid__")&&a._setClassId(b,c)},a.unregisterClass=function(a){"use strict";for(var b=0;b<arguments.length;b++){var e=arguments[b].prototype,f=e.__cid__;f&&delete c[f];var g=e.__classname__;g&&delete d[g]}},a._getClassById=function(a){return c[a]},a.getClassByName=function(a){return d[a]},a._getClassId=function(a){return"function"==typeof a&&a.prototype.__cid__?a.prototype.__cid__:a&&a.constructor&&a.constructor.prototype&&a.constructor.prototype.hasOwnProperty("__cid__")?a.__cid__:""},Object.defineProperty(a,"_registeredClassIds",{get:function(){var a={};for(var b in c)a[b]=c[b];return a},set:function(b){a.JS.clear(c);for(var d in b)c[d]=b[d]}}),Object.defineProperty(a,"_registeredClassNames",{get:function(){var a={};for(var b in d)a[b]=d[b];return a},set:function(b){a.JS.clear(d);for(var c in b)d[c]=b[c]}})}(),a.log=function(){console.log.apply(console,arguments)},a.info=function(){(console.info||console.log).apply(console,arguments)},a.warn=function(){console.warn.apply(console,arguments)},a.error=console.error.bind?console.error.bind(console):function(){console.error.apply(console,arguments)},function(){var b=Math.PI/180,c=180/Math.PI;a.mixin(Math,{TWO_PI:2*Math.PI,HALF_PI:.5*Math.PI,deg2rad:function(a){return a*b},rad2deg:function(a){return a*c},rad180:function(a){return(a>Math.PI||a<-Math.PI)&&(a=(a+Math.TOW_PI)%Math.TOW_PI),a},rad360:function(a){return a>Math.TWO_PI?a%Math.TOW_PI:0>a?Math.TOW_PI+a%Math.TOW_PI:a},deg180:function(a){return(a>180||-180>a)&&(a=(a+360)%360),a},deg360:function(a){return a>360?a%360:0>a?360+a%360:a},randomRange:function(a,b){return Math.random()*(b-a)+a},randomRangeInt:function(a,b){return Math.floor(this.randomRange(a,b))},clamp:function(a,b,c){return b="undefined"==typeof b?0:b,c="undefined"==typeof c?1:c,Math.min(Math.max(a,b),c)},calculateMaxRect:function(a,b,c,d,e){var f=Math.min(b.x,c.x,d.x,e.x),g=Math.max(b.x,c.x,d.x,e.x),h=Math.min(b.y,c.y,d.y,e.y),i=Math.max(b.y,c.y,d.y,e.y);return a.x=f,a.y=h,a.width=g-f,a.height=i-h,a}})}(),a.Intersection=function(){function b(a,b,c,d){var e,f=(d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x),g=(b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x),h=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!==h){var i=f/h,j=g/h;if(i>=0&&1>=i&&j>=0&&1>=j)return!0}return!1}function c(c,d,e){var f=new a.Vec2(e.x,e.y),g=new a.Vec2(e.x,e.yMax),h=new a.Vec2(e.xMax,e.yMax),i=new a.Vec2(e.xMax,e.y);return b(c,d,f,g)?!0:b(c,d,g,h)?!0:b(c,d,h,i)?!0:b(c,d,i,f)?!0:!1}function d(a,c,d){for(var e=d.points.length,f=0;e>f;++f){var g=d.points[f],h=d.points[(f+1)%e];if(b(a,c,g,h))return!0}return!1}function e(a,b){var c=a.x,d=a.y,e=a.x+a.width,f=a.y+a.height,g=b.x,h=b.y,i=b.x+b.width,j=b.y+b.height;return i>=c&&e>=g&&j>=d&&f>=h}function f(b,c){var e,f=new a.Vec2(b.x,b.y),g=new a.Vec2(b.x,b.yMax),h=new a.Vec2(b.xMax,b.yMax),i=new a.Vec2(b.xMax,b.y);if(d(f,g,c))return!0;if(d(g,h,c))return!0;if(d(h,i,c))return!0;if(d(i,f,c))return!0;for(e=0;e<c.points.length;++e)if(b.contains(c.points[e]))return!0;return c.contains(f)?!0:c.contains(g)?!0:c.contains(h)?!0:c.contains(i)?!0:!1}function g(a,b){var c;for(c=0;c<length;++c){var e=a.points[c],f=a.points[(c+1)%length];if(d(e,f,b))return!0}for(c=0;c<b.points.length;++c)if(a.contains(b.points[c]))return!0;for(c=0;c<a.points.length;++c)if(b.contains(a.points[c]))return!0;return!1}var h={};return h.lineLine=b,h.lineRect=c,h.linePolygon=d,h.rectRect=e,h.rectPolygon=f,h.polygonPolygon=g,h}(),function(){var b=function(){this._callbackTable={}};a._CallbacksHandler=b,b.prototype.add=function(a,b){var c=this._callbackTable[a];return"undefined"!=typeof c?(b&&(null!==c?c.push(b):(c=[b],this._callbackTable[a]=c)),!1):(c=b?[b]:null,this._callbackTable[a]=c,!0)},b.prototype.has=function(a,b){var c=this._callbackTable[a];return c&&c.length>0?b?-1!==c.indexOf(b):!0:!1},b.prototype.removeAll=function(a){delete this._callbackTable[a]},b.prototype.remove=function(a,b){var c=this._callbackTable[a];if(c){var d=c.indexOf(b);if(-1!==d)return c.splice(d,1),!0}return!1};var c=function(){this._callbackTable={}};return a.extend(c,b),a.CallbacksInvoker=c,c.prototype.invoke=function(a,b,c,d,e,f){var g=this._callbackTable[a];if(g)for(var h=0;h<g.length;h++)g[h](b,c,d,e,f)},c.prototype.invokeAndRemove=function(a,b,c,d,e,f){var g=this._callbackTable[a];if(g)for(var h=0;h<g.length;h++)g[h](b,c,d,e,f);this.removeAll(a)},c.prototype.bindKey=function(a,b){var c=this;return function d(e,f,g,h,i){var j=c._callbackTable[a];if(j)for(var k=0;k<j.length;k++)j[k](e,f,g,h,i);b&&c.removeAll(a)}},c}(),a.padLeft=function(a,b,c){return a=a.toString(),b-=a.length,b>0?new Array(b+1).join(c)+a:a},a.getEnumList=function(a){if(void 0!==a.__enums__)return a.__enums__;var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d=parseInt(c);isNaN(d)&&b.push({name:a[a[c]],value:a[c]})}return b.sort(function(a,b){return a.value-b.value}),a.__enums__=b,a.__enums__},a.getVarFrom=function(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;++e){var f=c[e];if(d=d[f],void 0===d||null===d)return null}return d},a.rgb2hsv=function(a,b,c){var d={h:0,s:0,v:0},e=Math.max(a,b,c),f=Math.min(a,b,c),g=0;return d.v=e,d.s=e?(e-f)/e:0,d.s?(g=e-f,d.h=a===e?(b-c)/g:b===e?2+(c-a)/g:4+(a-b)/g,d.h/=6,d.h<0&&(d.h+=1)):d.h=0,d},a.hsv2rgb=function(a,b,c){var d={r:0,g:0,b:0};if(0===b)d.r=d.g=d.b=c;else if(0===c)d.r=d.g=d.b=0;else{1===a&&(a=0),a*=6,b=b,c=c;var e=Math.floor(a),f=a-e,g=c*(1-b),h=c*(1-b*f),i=c*(1-b*(1-f));switch(e){case 0:d.r=c,d.g=i,d.b=g;break;case 1:d.r=h,d.g=c,d.b=g;break;case 2:d.r=g,d.g=c,d.b=i;break;case 3:d.r=g,d.g=h,d.b=c;break;case 4:d.r=i,d.g=g,d.b=c;break;case 5:d.r=c,d.g=g,d.b=h}}return d};var r=function(a){if(a.constructor!=={}.constructor)return!1;for(var b in a)return!1;return!0},s=function(a){return a&&"function"==typeof a.clone&&(a.constructor.prototype.hasOwnProperty("clone")||a.hasOwnProperty("clone"))};a.attr=function(a,b,c){var d="_attr$"+b,e=a.prototype[d];if(c){e||(e={},a.prototype[d]=e);for(var f in c)"_"!==f[0]&&(e[f]=c[f])}return e},a.NonSerialized={serializable:!1,_canUsedInGetter:!1},a.EditorOnly={editorOnly:!0,_canUsedInGetter:!1},a.Integer={type:"int"},a.Float={type:"float"},a.SingleText={textMode:"single"},a.MultiText={textMode:"multi"},a.Boolean={type:"boolean",_onAfterProp:e("boolean","Fire.Boolean")},a.String={type:"string",_onAfterProp:e("string","Fire.String")},a.ObjectType=function(a){return{type:"object",ctor:a}},a.Enum=function(b){return{type:"enum",enumList:a.getEnumList(b)}},a.EnumList=function(a){return{type:"enum",enumList:a}},a.RawType=function(b){var c=["image","json","text","audio"];return{type:"raw",rawType:b,serializable:!1,hideInInspector:!0,_canUsedInGetter:!1,_onAfterProp:function(b,d){var e=function h(b){if(!a.isChildClassOf(b,B))return a.error("RawType is only available for Assets"),!1;for(var c=!1,d=0;d<b.__props__.length;d++){var e=b.__props__[d],f=a.attr(b,e),g=f.type;if("raw"===g){var h=f.rawType.toLowerCase()!==f.rawType;if(h)return a.error("RawType name cannot contain uppercase"),!1;if(c)return a.error("Each asset cannot have more than one RawType"),!1;c=!0}}return!0}(b);if(e){var f=a.attr(b,d)||{},g=-1!==c.indexOf(f.rawType);g&&b.prop("_rawext","",a.HideInInspector)}}}},a.Custom=function(a){return{custom:a}},a.HideInInspector={hideInInspector:!0},a.DisplayName=function(a){return{displayName:a}},a.ReadOnly={readOnly:!0},a.Tooltip=function(a){return{tooltip:a}},a.Nullable=function(b,c){return{nullable:b,_onAfterProp:function(d,e){d.prop(b,c,a.HideInInspector);var f=a.attr(d,e)||{};f.serializable===!1?a.attr(d,b,a.NonSerialized):f.editorOnly&&a.attr(d,b,a.EditorOnly)}}},a.Watch=function(a,b){return{watch:[].concat(a),watchCallback:b}},a.Range=function(a,b){return{min:a,max:b}};var t=function(b){var c=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/;if(!c.test(b))return void a.error('The property name "'+b+'" is not compliant with JavaScript naming standards');if(this.__props__){var d=this.__props__.indexOf(b);0>d&&this.__props__.push(b)}else this.__props__=[b]},u={__props__:null,prop:function(b,c,d){"use strict";if("object"==typeof c&&c)if(Array.isArray(c)){if(c.length>0)return a.error("Default array must be empty, set default value of "+a.getClassName(this)+'.prop("'+b+'", ...) to null or [], and initialize in constructor please. (just like "this.'+b+' = [...];")'),this}else if(!r(c)&&!s(c))return a.error('Do not set default value to non-empty object, unless the object defines its own "clone" function. Set default value of '+a.getClassName(this)+'.prop("'+b+'", ...) to null or {}, and initialize in constructor please. (just like "this.'+b+' = {foo: bar};")'),this;for(var e=this.$super;e;e=e.$super)if(e.prototype.hasOwnProperty(b))return void a.error("Can not declare "+a.getClassName(this)+"."+b+", it is already defined in the prototype of "+a.getClassName(e));if(a.attr(this,b,{"default":c}),t.call(this,b),d){for(var f=null,g=2,h=g;h<arguments.length;h++){var i=arguments[h];a.attr(this,b,i),i._onAfterProp&&(f=f||[],f.push(i._onAfterProp))}if(f)for(var j=0;j<f.length;j++)f[j](this,b)}return this},get:function(b,c,d){"use strict";var e=Object.getOwnPropertyDescriptor(this.prototype,b);if(e&&e.get)return a.error(a.getClassName(this)+': the getter of "'+b+'" is already defined!'),this;var f=!0;if(d)for(var g=2,h=g;h<arguments.length;h++){var i=arguments[h];if(i._canUsedInGetter!==!1){if(a.attr(this,b,i),i.hideInInspector&&(f=!1),(i.serializable===!1||i.editorOnly===!0)&&a.warn("No need to use Fire.NonSerialized or Fire.EditorOnly for the getter of "+a.getClassName(this)+"."+b+", every getter is actually non-serialized."),i.hasOwnProperty("default"))return a.error(a.getClassName(this)+": Can not set default value of a getter!"),this}else a.error('Can not apply the specified attribute to the getter of "'+a.getClassName(this)+"."+b+'", attribute index: '+(h-g))}if(a.attr(this,b,a.NonSerialized),f)t.call(this,b);else{var j=this.__props__.indexOf(b);if(j>=0)return a.error(a.getClassName(this)+"."+b+" is already defined!"),this}return Object.defineProperty(this.prototype,b,{get:c,configurable:!0}),a.attr(this,b,{hasGetter:!0}),this},set:function(b,c){var d=Object.getOwnPropertyDescriptor(this.prototype,b);return d&&d.set?(a.error(a.getClassName(this)+': the setter of "'+b+'" is already defined!'),this):(Object.defineProperty(this.prototype,b,{set:function(a){this._observing&&Object.getNotifier(this).notify({type:"update",name:b,oldValue:this[b]}),c.call(this,a)},configurable:!0}),a.attr(this,b,{hasSetter:!0}),a.attr(this,b,{originalSetter:c}),this)},getset:function(a,b,c,d){return this.get(a,b,d),this.set(a,c),this}},v=function(b,c){var d=c.__props__;if(d)for(var e=0;e<d.length;e++){var f=d[e],g=a.attr(c,f);if(g&&g.hasOwnProperty("default")){var h=g["default"];"object"==typeof h&&h&&(h=h.clone?h.clone():Array.isArray(h)?[]:{}),b[f]=h}}};a._isFireClass=function(a){return!!a&&a.prop===u.prop},a.isChildClassOf=function(b,c){if(b&&c){if("function"!=typeof b)return a.warn("[isChildClassOf] subclass should be function type, not",b),!1;if("function"!=typeof c)return a.warn("[isChildClassOf] superclass should be function type, not",c),!1;for(;b&&b.$super;b=b.$super)if(b===c)return!0;if(b===c)return!0;for(var d=Object.getPrototypeOf(b.prototype);d;){if(b=d.constructor,b===c)return!0;d=Object.getPrototypeOf(b.prototype)}}return!1},a.define=function(b,c,d){"use strict";var e=!1;switch(arguments.length){case 2:e=a._isFireClass(c);break;case 3:e=!0}var i;e?i=c:d=c,d&&g(d);var j=f(e,d,i);for(var k in u)Object.defineProperty(j,k,{value:u[k],writable:"__props__"===k,enumerable:"__props__"===k});return e&&(a.extend(j,i),j.$super=i,i.__props__&&(j.__props__=i.__props__.slice())),a.setClassName(b,j),h(j,b),j},a._fastDefine=function(b,c,d){a.setClassName(b,c),c.__props__=d;for(var e=0;e<d.length;e++)a.attr(c,d[e],a.HideInInspector)},a.Path=a.isNode?require("path"):function(){var b;if(a.isWin32){var c=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,d=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/;b=function(a){var b=c.exec(a),e=(b[1]||"")+(b[2]||""),f=b[3]||"",g=d.exec(f),h=g[1],i=g[2],j=g[3];return[e,h,i,j]}}else{var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;b=function(a){return e.exec(a).slice(1)}}return path={basename:function(a){return a.replace(/^.*(\\|\/|\:)/,"")},extname:function(a){return a.substring((~-a.lastIndexOf(".")>>>0)+1)},dirname:function(a){var c=b(a),d=c[0],e=c[1];return d||e?(e&&(e=e.substr(0,e.length-1)),d+e):"."},sep:a.isWin32?"\\":"/"},path}(),a.Path.setExtname=function(a,b){var c=(~-a.lastIndexOf(".")>>>0)+1;return a.substring(0,c)+b},a.Path.setEndWithSep=function(b,c){c="undefined"!=typeof c?c:!0;var d=b[b.length-1],e="\\"===d||"/"===d;return!e&&c?b+=a.Path.sep:e&&!c&&(b=b.substring(0,b.length-1)),b},FObject=function(){function b(){this._name="",this._objFlags=0}a._fastDefine("Fire.FObject",b,["_name","_objFlags"]),a.isValid=function(a){return!(!a||a._objFlags&k)},Object.defineProperty(b,"isValid",{value:function(b){return a.warn("FObject.isValid is deprecated, use Fire.isValid instead please"),a.isValid(b)},enumerable:!1});var c=[];return Object.defineProperty(b,"_deferredDestroy",{value:function(){for(var a=c.length,b=0;a>b;++b){var d=c[b];d._objFlags&k||d._destroyImmediate()}a===c.length?c.length=0:c.splice(0,a)},enumerable:!1}),Object.defineProperty(b.prototype,"name",{get:function(){return this._name},set:function(a){this._name=a},enumerable:!1}),Object.defineProperty(b.prototype,"isValid",{get:function(){return!(this._objFlags&k)}}),b.prototype.destroy=function(){return this._objFlags&k?void a.error("object already destroyed"):this._objFlags&l?!1:(this._objFlags|=l,c.push(this),!0)},b.prototype._destruct=function(){for(var a in this)if(this.hasOwnProperty(a)){var b=typeof this[a];switch(b){case"string":this[a]="";break;case"object":this[a]=null;break;case"function":this[a]=null}}},b.prototype._destroyImmediate=function(){return this._objFlags&k?void a.error("object already destroyed"):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),void(this._objFlags|=k))},b}(),a.FObject=FObject;var w=function(){var b=a.define("Fire.HashObject",a.FObject,function(){FObject.call(this),Object.defineProperty(this,"_hashCode",{value:0,writable:!0,enumerable:!1}),Object.defineProperty(this,"_id",{value:"",writable:!0,enumerable:!1})}),c=0;return Object.defineProperty(b.prototype,"hashCode",{get:function(){return this._hashCode||(this._hashCode=++c)}}),Object.defineProperty(b.prototype,"id",{get:function(){return this._id||(this._id=""+this.hashCode)}}),b}();a.HashObject=w,Vec2=function(){function b(a,b){this.x="number"==typeof a?a:0,this.y="number"==typeof b?b:0}return a.setClassName("Fire.Vec2",b),Object.defineProperty(b,"one",{get:function(){return new b(1,1)}}),Object.defineProperty(b,"zero",{get:function(){return new b(0,0)}}),b.prototype.clone=function(){return new b(this.x,this.y)},b.prototype.set=function(a){this.x=a.x,this.y=a.y},b.prototype.equals=function(b){return b&&b.constructor===a.Vec2?this.x===b.x&&this.y===b.y:!1},b.prototype.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},b.prototype.addSelf=function(a){return this.x+=a.x,this.y+=a.y,this},b.prototype.add=function(a,c){return c=c||new b,c.x=this.x+a.x,c.y=this.y+a.y,c},b.prototype.subSelf=function(a){return this.x-=a.x,this.y-=a.y,this},b.prototype.sub=function(a,c){return c=c||new b,c.x=this.x-a.x,c.y=this.y-a.y,c},b.prototype.mulSelf=function(a){return this.x*=a,this.y*=a,this},b.prototype.mul=function(a,c){return c=c||new b,c.x=this.x*a,c.y=this.y*a,c},b.prototype.scaleSelf=function(a){return this.x*=a.x,this.y*=a.y,this},b.prototype.scale=function(a,c){return c=c||new b,c.x=this.x*a.x,c.y=this.y*a.y,c},b.prototype.divSelf=function(a){return this.x/=a.x,this.y/=a.y,this},b.prototype.div=function(a,c){return c=c||new b,c.x=this.x/a.x,c.y=this.y/a.y,c},b.prototype.negSelf=function(){return this.x=-this.x,this.y=-this.y,this},b.prototype.neg=function(a){return a=a||new b,a.x=-this.x,a.y=-this.y,a},b.prototype.dot=function(a){return this.x*a.x+this.y*a.y},b.prototype.cross=function(a){return this.y*a.x-this.x*a.y},b.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},b.prototype.magSqr=function(){return this.x*this.x+this.y*this.y},b.prototype.normalizeSelf=function(){var a=this.x*this.x+this.y*this.y;if(1===a)return this;if(0===a)return console.warn("Can't normalize zero vector"),this;var b=1/Math.sqrt(a);return this.x*=b,this.y*=b,this},b.prototype.normalize=function(a){return a=a||new b,a.x=this.x,a.y=this.y,a.normalizeSelf(),a},b.prototype.angle=function(a){var b=this.magSqr(),c=a.magSqr();if(0===b||0===c)return console.warn("Can't get angle between zero vector"),0;var d=this.dot(a),e=d/Math.sqrt(b*c);return e=Math.clamp(e,-1,1),Math.acos(e)},b.prototype.signAngle=function(a){return Math.atan2(this.y,this.x)-Math.atan2(a.y,a.x)},b.prototype.rotate=function(a,c){return c=c||new b,c.x=this.x,c.y=this.y,c.rotateSelf(a)},b.prototype.rotateSelf=function(a){var b=Math.sin(a),c=Math.cos(a),d=this.x;return this.x=c*d-b*this.y,this.y=b*d+c*this.y,this},b}(),a.Vec2=Vec2,a.v2=function X(a,b){return Array.isArray(a)?new Vec2(a[0],a[1]):new Vec2(a,b)};var x=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};a.setClassName("Fire.Matrix23",x),a.Matrix23=x,x.identity=new x,x.prototype.clone=function(){var a=new x;return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},x.prototype.set=function(a){this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.tx=a.tx,this.ty=a.ty},x.prototype.equals=function(a){return this.a===a.a&&this.b===a.b&&this.c===a.c&&this.d===a.d&&this.tx===a.tx&&this.ty===a.ty},x.prototype.toString=function(){return"|"+this.a.toFixed(2)+" "+this.c.toFixed(2)+" "+this.tx.toFixed(2)+"|\n|"+this.b.toFixed(2)+" "+this.d.toFixed(2)+" "+this.ty.toFixed(2)+"|\n|0.00 0.00 1.00|"},x.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},x.prototype.prepend=function(a){var b=a.a,c=a.b,d=a.c,e=a.d;if(1!==b||0!==c||0!==d||1!==e){var f=this.a,g=this.c;this.a=f*b+this.b*d,this.b=f*c+this.b*e,this.c=g*b+this.d*d,this.d=g*c+this.d*e;var h=this.tx;this.tx=h*b+this.ty*d+a.tx,this.ty=h*c+this.ty*e+a.ty}else this.tx+=a.tx,this.ty+=a.ty;return this},x.prototype.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=1/(a*d-b*c);return this.a=d*f,this.b=-b*f,this.c=-c*f,this.d=a*f,this.tx=(c*this.ty-d*e)*f,this.ty=(b*e-a*this.ty)*f,this},x.prototype.transformPoint=function(a,b){b=b||new Vec2;var c=a.x;return b.x=this.a*c+this.c*a.y+this.tx,b.y=this.b*c+this.d*a.y+this.ty,b},x.prototype.getScale=function(a){return a=a||new Vec2,a.x=Math.sqrt(this.a*this.a+this.b*this.b),a.y=Math.sqrt(this.c*this.c+this.d*this.d),a},x.prototype.setScale=function(a){var b=this.getScale(),c=a.x/b.x,d=a.y/b.y;return this.a*=c,this.b*=c,this.c*=d,this.d*=d,this},x.prototype.getRotation=function(){var a=this.b/this.a!==-this.c/this.d;return a?.5*(Math.atan2(this.b,this.a)+Math.atan2(-this.c,this.d)):Math.atan2(-this.c,this.d)},x.prototype.getTranslation=function(a){return a=a||new Vec2,a.x=this.tx,a.y=this.ty,a},x.prototype.rotate=function(a){var b=Math.sin(a),c=Math.cos(a),d=this.a,e=this.b;return this.a=d*c+this.c*b,this.b=e*c+this.d*b,this.c=this.c*c-d*b,this.d=this.d*c-e*b,this};var y=function(){function b(a,b,c,d){this.x="number"==typeof a?a:0,this.y="number"==typeof b?b:0,this.width="number"==typeof c?c:0,this.height="number"==typeof d?d:0}return a.setClassName("Fire.Rect",b),b.fromVec2=function(a,c){var d=Math.min(a.x,c.x),e=Math.min(a.y,c.y),f=Math.max(a.x,c.x),g=Math.max(a.y,c.y);return new b(d,e,f-d,g-e)},b.contain=function c(a,b){return a.x<=b.x&&a.x+a.width>=b.x+b.width&&a.y<=b.y&&a.y+a.height>=b.y+b.height?1:b.x<=a.x&&b.x+b.width>=a.x+a.width&&b.y<=a.y&&b.y+b.height>=a.y+a.height?-1:0},b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)},b.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height},b.prototype.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},Object.defineProperty(b.prototype,"xMax",{get:function(){return this.x+this.width}}),Object.defineProperty(b.prototype,"yMax",{get:function(){return this.y+this.height}}),Object.defineProperty(b.prototype,"center",{get:function(){return new a.Vec2(this.x+.5*this.width,this.y+.5*this.height)}}),b.prototype.intersects=function(b){return a.Intersection.rectRect(this,b)},b.prototype.contains=function(a){return this.x<=a.x&&this.x+this.width>=a.x&&this.y<=a.y&&this.y+this.height>=a.y?!0:!1},b.prototype.containsRect=function(a){return this.x<=a.x&&this.x+this.width>=a.x+a.width&&this.y<=a.y&&this.y+this.height>=a.y+a.height?!0:!1},b}();a.Rect=y,a.rect=function Y(a,b,c,d){return Array.isArray(a)?new y(a[0],a[1],a[2],a[3]):new y(a,b,c,d)},a.Polygon=function(){function b(a){this.points=a,this.points.length<3&&console.warn("Invalid polygon, the data must contains 3 or more points.")}return a.setClassName("Fire.Polygon",b),b.prototype.intersects=function(a){return Intersection.polygonPolygon(this,a)},b.prototype.contains=function(a){for(var b=!1,c=a.x,d=a.y,e=this.points.length,f=0,g=e-1;e>f;g=f++){var h=this.points[f].x,i=this.points[f].y,j=this.points[g].x,k=this.points[g].y,l=i>d!=k>d&&(j-h)*(d-i)/(k-i)+h>c;l&&(b=!b)}return b},Object.defineProperty(b.prototype,"center",{get:function(){if(this.points.length<3)return null;for(var b=this.points[0].x,c=this.points[0].y,d=this.points[0].x,e=this.points[0].y,f=1;f<this.points.length;++f){var g=this.points[f].x,h=this.points[f].y;b>g?b=g:g>d&&(d=g),c>h?c=h:h>e&&(e=h)}return new a.Vec2(.5*(d+b),.5*(e+c))}}),b}();var z=function(){function b(a,b,c,d){this.r="number"==typeof a?a:0,this.g="number"==typeof b?b:0,this.b="number"==typeof c?c:0,this.a="number"==typeof d?d:1}return a.setClassName("Fire.Color",b),b.prototype.clone=function(){return new b(this.r,this.g,this.b,this.a)},b.prototype.equals=function(a){return this.r===a.r&&this.g===a.g&&this.b===a.b&&this.a===a.a},b.prototype.toString=function(){return"rgba("+this.r.toFixed(2)+", "+this.g.toFixed(2)+", "+this.b.toFixed(2)+", "+this.a.toFixed(2)+")"},b.prototype.toCSS=function(a){return"rgba"===a?"rgba("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+","+this.a.toFixed(2)+")":"rgb"===a?"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")":"#"+this.toHEX(a)},b.prototype.equalTo=function(a){return a instanceof b&&this.r===a.r&&this.g===a.g&&this.b===a.b&&this.a===a.a},b.prototype.clamp=function(){this.r=Math.clamp(this.r),this.g=Math.clamp(this.g),this.b=Math.clamp(this.b),this.a=Math.clamp(this.a)},b.prototype.fromHEX=function(a){var b=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return this.r=b>>16,this.g=(65280&b)>>8,this.b=255&b,this},b.prototype.toHEX=function(a){var b=[(255*this.r|0).toString(16),(255*this.g|0).toString(16),(255*this.b|0).toString(16)],c=-1;if("#rgb"===a)for(c=0;c<b.length;++c)b[c].length>1&&(b[c]=b[c][0]);else if("#rrggbb"===a)for(c=0;c<b.length;++c)1===b[c].length&&(b[c]="0"+b[c]);return b.join("")},b.prototype.toRGBValue=function(){return(255*this.r<<16)+(255*this.g<<8)+255*this.b},b.prototype.fromHSV=function(b,c,d){var e=a.hsv2rgb(b,c,d);return this.r=e.r,this.g=e.g,this.b=e.b,this},b.prototype.toHSV=function(){return a.rgb2hsv(this.r,this.g,this.b)},b}();a.Color=z,a.color=function Z(a,b,c,d){return Array.isArray(a)?new z(a[0],a[1],a[2],a[3]):new z(a,b,c,d)};var A=function(){function b(b,c,d,g,h){if(this._editor=g,this._classFinder=h,this._target=d,this._idList=[],this._idObjList=[],this._idPropList=[],this.result=c||new a._DeserializeInfo,Array.isArray(b)){var i=b,j=i.length;this.deserializedList=new Array(j);for(var k=0;j>k;k++)if(i[k]){var l;l=0===k&&d,this.deserializedList[k]=f(this,i[k],l)}this.deserializedData=j>0?this.deserializedList[0]:[]}else this.deserializedList=[null],this.deserializedData=b?f(this,b,d):null,this.deserializedList[0]=this.deserializedData;e(this)}function c(a,b,c,d,e){var g=c.__id__;if("undefined"==typeof g){var h=c.__uuid__;if(h){if(e&&e[d]&&e[d]._uuid===h)return;a.result.uuidList.push(h),a.result.uuidObjList.push(b),a.result.uuidPropList.push(d)}else b[d]=f(a,c,e&&e[d])}else{var i=a.deserializedList[g];i?b[d]=i:(a._idList.push(g),a._idObjList.push(b),a._idPropList.push(d))}}function d(a,b,d){for(var e in b){var g=d[e];"undefined"!=typeof g&&d.hasOwnProperty(e)&&("object"!=typeof g?b[e]=g:g?g.__uuid__||"undefined"!=typeof g.__id__?c(a,b,g,e,a._target&&b):b[e]=f(a,g,a._target&&b[e]):b[e]=null)}}var e=function(a){for(var b=a.deserializedList,c=0,d=a._idList.length;d>c;c++){var e=a._idPropList[c],f=a._idList[c];a._idObjList[c][e]=b[f]}},f=function(b,e,g){var h,i,j=null,k=null;if(e.__type__){if(k=b._classFinder(e.__type__),!k)return a.error("[Fire.deserialize] unknown type: "+e.__type__),null;g?(g instanceof k||a.warn("Type of target to deserialize not matched with data: target is %s, data is %s",a.getClassName(g),k),j=g):j=new k}else{if(Array.isArray(e)){g?(g.length=e.length,j=g):j=e;for(var l=0;l<e.length;l++)i=e[l],"object"==typeof i&&i?i.__uuid__||"undefined"!=typeof i.__id__?c(b,j,i,""+l,g&&g[l]):j[l]=f(b,i,g&&g[l]):g&&(j[l]=e[l]);return j}j=g||e}if(k&&a._isFireClass(k)){var m=k.__props__;if(!m)return j;for(var n=0;n<m.length;n++){h=m[n];var o=a.attr(k,h),p=o.rawType;if(p)b.result.rawProp&&a.error("not support multi raw object in a file"),b.result.rawProp=h;else{if(o.serializable===!1)continue;if(!b._editor&&o.editorOnly)continue;i=e[h],"undefined"!=typeof i&&("object"!=typeof i?j[h]=i:i?i.__uuid__||"undefined"!=typeof i.__id__?c(b,j,i,h,g&&j):j[h]=f(b,i,g&&g[h]):j[h]=null)}}"_$erialized"===m[m.length-1]&&(j._$erialized=e,d(b,j._$erialized,e))}else d(b,j,e);return j};return b}();a.deserialize=function(b,c,d){var e=d&&"isEditor"in d?d.isEditor:a.isEditor,f=d&&d.classFinder||a._getClassById,g=d&&d.createAssetRefs||a.isEditorCore,h=d&&d.target;a.isNode&&Buffer.isBuffer(b)&&(b=b.toString()),"string"==typeof b&&(b=JSON.parse(b)),g&&!c&&(c=new a._DeserializeInfo),a._isCloning=!0;var i=new A(b,c,h,e,f);return a._isCloning=!1,g&&c.assignAssetsBy(a.serialize.asAsset),i.deserializedData},a._DeserializeInfo=function(){this.uuidList=[],this.uuidObjList=[],this.uuidPropList=[],this.rawProp=""},a._DeserializeInfo.prototype.reset=function(){this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp=""},a._DeserializeInfo.prototype.getUuidOf=function(a,b){for(var c=0;c<this.uuidObjList.length;c++)if(this.uuidObjList[c]===a&&this.uuidPropList[c]===b)return this.uuidList[c];return""},a._DeserializeInfo.prototype.assignAssetsBy=function(b){for(var c=0,d=this.uuidList.length;d>c;c++){var e=this.uuidList[c],f=b(e);if(f){var g=this.uuidObjList[c],h=this.uuidPropList[c];g[h]=f}else a.error("Failed to assign asset: "+e)}},a.instantiate=function(b){if("object"!=typeof b||Array.isArray(b))return a.error("The thing you want to instantiate must be an object"),null;if(!b)return a.error("The thing you want to instantiate is nil"),null;if(b instanceof a.FObject&&!b.isValid)return a.error("The thing you want to instantiate is destroyed"),null;var c;return b._instantiate?(a._isCloning=!0,c=b._instantiate(),a._isCloning=!1,c):b instanceof a.Asset?(a.error("The instantiate method for given asset do not implemented"),null):(a._isCloning=!0,c=a._doInstantiate(b),a._isCloning=!1,c)
},a._doInstantiate=function(){function b(b){if(Array.isArray(b))return a.error("Can not instantiate array"),null;if(d(b))return a.error("Can not instantiate DOM element"),null;for(var c=f(b),g=0,h=e.length;h>g;++g)e[g]._iN$t=null;return e.length=0,c}function c(a){var b=a._iN$t;if(b)return b;if(a instanceof B)return a;if(Array.isArray(a)){var g=a.length;b=new Array(g),a._iN$t=b;for(var h=0;g>h;++h){var i=a[h],j=typeof i;b[h]="object"===j?i?c(i):i:"function"!==j?i:null}return e.push(a),b}return d(a)?null:f(a)}var e=[],f=function(b){var d,f,g=b.constructor,h=new g;if(b._iN$t=h,e.push(b),a._isFireClass(g)){var i=g.__props__;if(i)for(var j=0;j<i.length;j++){var k=i[j],l=a.attr(g,k);l.serializable!==!1&&(d=b[k],f=typeof d,h[k]="object"===f?d?c(d):d:"function"!==f?d:null)}}else for(var m in b)b.hasOwnProperty(m)===!1||95===m.charCodeAt(0)&&95===m.charCodeAt(1)||(d=b[m],d!==h&&(f=typeof d,h[m]="object"===f?d?c(d):d:"function"!==f?d:null));return b instanceof FObject&&(h._objFlags&=q),h};return b}(),a._isCloning=!1;var B=function(){var b=a.define("Fire.Asset",a.HashObject,function(){a.HashObject.call(this),Object.defineProperty(this,"_uuid",{value:"",writable:!0,enumerable:!1})});return b.prototype._setRawExtname=function(b){this.hasOwnProperty("_rawext")?("."===b.charAt(0)&&(b=b.substring(1)),this._rawext=b):a.error("Have not defined any RawTypes yet, no need to set raw file's extname.")},b}();a.Asset=B;var C=function(){var b=a.define("Fire.CustomAsset",a.Asset);return b}();a.CustomAsset=C,a.addCustomAssetMenu=a.addCustomAssetMenu||function(a,b,c){},a.Texture=function(){var b=a.define("Fire.Texture",a.Asset,function(){b.$super.call(this);var a=arguments[0];a&&(this.image=a,this.width=a.width,this.height=a.height)});return b.WrapMode=function(a){return a[a.Repeat=0]="Repeat",a[a.Clamp=1]="Clamp",a}({}),b.FilterMode=function(a){return a[a.Point=0]="Point",a[a.Bilinear=1]="Bilinear",a[a.Trilinear=2]="Trilinear",a}({}),b.prop("image",null,a.RawType("image")),b.prop("width",0,a.Integer),b.prop("height",0,a.Integer),b.prop("wrapMode",b.WrapMode.Clamp,a.Enum(b.WrapMode)),b.prop("filterMode",b.FilterMode.Bilinear,a.Enum(b.FilterMode)),b}(),a.Sprite=function(){var b=a.define("Fire.Sprite",a.Asset,function(){b.$super.call(this);var c=arguments[0];c&&(this.texture=new a.Texture(c),this.width=c.width,this.height=c.height)});return b.prop("texture",null,a.ObjectType(a.Texture),a.Tooltip("texture to render")),b.prop("rotated",!1),b.prop("pivot",new a.Vec2(.5,.5),a.Tooltip("The pivot is normalized, like a percentage.\n(0,0) means the bottom-left corner and (1,1) means the top-right corner.\nBut you can use values higher than (1,1) and lower than (0,0) too.")),b.prop("trimX",0,a.Integer),b.prop("trimY",0,a.Integer),b.prop("rawWidth",0,a.Integer),b.prop("rawHeight",0,a.Integer),b.prop("x",0,a.Integer),b.prop("y",0,a.Integer),b.prop("width",0,a.Integer,a.Tooltip("trimmed width")),b.prop("height",0,a.Integer,a.Tooltip("trimmed height")),Object.defineProperty(b.prototype,"rotatedWidth",{get:function(){return this.rotated?this.height:this.width}}),Object.defineProperty(b.prototype,"rotatedHeight",{get:function(){return this.rotated?this.width:this.height}}),b}(),a.Atlas=function(){var b=a.define("Fire.Atlas",a.Asset,null);return b.Algorithm=function(a){return a[a.Basic=0]="Basic",a[a.Tree=1]="Tree",a[a.MaxRect=2]="MaxRect",a}({}),b.SortBy=function(a){return a[a.UseBest=0]="UseBest",a[a.Width=1]="Width",a[a.Height=2]="Height",a[a.Area=3]="Area",a[a.Name=4]="Name",a}({}),b.SortOrder=function(a){return a[a.UseBest=0]="UseBest",a[a.Ascending=1]="Ascending",a[a.Descending=2]="Descending",a}({}),b.prop("width",512,a.Integer),b.prop("height",512,a.Integer),b.prop("sprites",[],a.ObjectType(a.Sprite),a.HideInInspector),b.prototype.add=function(a){for(var b=0;b<this.sprites.length;++b){var c=this.sprites[b];if(c._uuid===a._uuid)return!1}return this.sprites.push(a),!0},b.prototype.remove=function(a){for(var b=0;b<this.sprites.length;++b){var c=this.sprites[b];if(c._uuid===a._uuid)return this.sprites.splice(b,1),!0}return!1},b.prototype.clear=function(){this.sprites=[]},b.prototype.layout=function(b){void 0===b.algorithm&&(b.algorithm=a.Atlas.Algorithm.MaxRect),void 0===b.sortBy&&(b.sortBy=a.Atlas.SortBy.UseBest),void 0===b.sortOrder&&(b.sortOrder=a.Atlas.SortOrder.UseBest),void 0===b.allowRotate&&(b.allowRotate=!0),void 0===b.autoSize&&(b.autoSize=!0),void 0===b.padding&&(b.padding=2),a.AtlasUtils.sort(this,b.algorithm,b.sortBy,b.sortOrder,b.allowRotate),a.AtlasUtils.layout(this,b.algorithm,b.autoSize,b.padding,b.allowRotate)},b}();var D={},E=function(a,b){for(var c=0,d=0,e=0,f=0;f<a.sprites.length;++f){var g=a.sprites[f];if(c+g.rotatedWidth>a.width&&(c=0,d=d+e+b,e=0),d+g.rotatedHeight>a.height)throw new Error("Warning: Failed to layout element "+g.name);g.x=c,g.y=d,c=c+g.rotatedWidth+b,g.rotatedHeight>e&&(e=g.rotatedHeight)}},F=function(b,c,d,e){if(null!==b.right){var f=F(b.right,c,d,e);return null!==f?f:F(b.bottom,c,d,e)}var g=c.rotatedWidth,h=c.rotatedHeight,i=g+d,j=h+d,k=b.rect;if(g>k.width||h>k.height){if(e===!1)return null;if(h>k.width||g>k.height)return null;c.rotated=!c.rotated,g=c.rotatedWidth,h=c.rotatedHeight,i=g+d,j=h+d}return b.right={rect:new a.Rect(k.x+i,k.y,k.width-i,h),right:null,bottom:null},b.bottom={rect:new a.Rect(k.x,k.y+j,k.width,k.height-j),right:null,bottom:null},[k.x,k.y]},G=function(b,c,d){for(var e={rect:new a.Rect(0,0,b.width,b.height),right:null,bottom:null},f=0;f<b.sprites.length;++f){var g=b.sprites[f],h=F(e,g,c,d);if(null===h)throw new Error("Warning: Failed to layout element "+g.name);g.x=h[0],g.y=h[1]}},H=function(a,b,c){if(c.x>=b.x+b.width||c.x+c.width<=b.x||c.y>=b.y+b.height||c.y+c.height<=b.y)return!1;var d;return c.x<b.x+b.width&&c.x+c.width>b.x&&(c.y>b.y&&c.y<b.y+b.height&&(d=b.clone(),d.height=c.y-d.y,a.push(d)),c.y+c.height<b.y+b.height&&(d=b.clone(),d.y=c.y+c.height,d.height=b.y+b.height-(c.y+c.height),a.push(d))),c.y<b.y+b.height&&c.y+c.height>b.y&&(c.x>b.x&&c.x<b.x+b.width&&(d=b.clone(),d.width=c.x-d.x,a.push(d)),c.x+c.width<b.x+b.width&&(d=b.clone(),d.x=c.x+c.width,d.width=b.x+b.width-(c.x+c.width),a.push(d))),!0},I=function(a,b){var c;for(c=0;c<a.length;++c)H(a,a[c],b)&&(a.splice(c,1),--c);for(c=0;c<a.length;++c)for(var d=c+1;d<a.length;++d){if(a[d].containsRect(a[c])){a.splice(c,1),--c;break}a[c].containsRect(a[d])&&(a.splice(d,1),--d)}},J=function(b,c,d){var e=[];e.push(new a.Rect(0,0,b.width+c,b.height+c));for(var f,g=function(b,c,d,e){f=Number.MAX_VALUE,score2=Number.MAX_VALUE;for(var g=new a.Rect(0,0,1,1),h=!1,i=0;i<b.length;++i){var j=b[i],k,l,m,n;j.width>=c&&j.height>=d&&(k=Math.abs(Math.floor(b[i].width)-c),l=Math.abs(Math.floor(b[i].height)-d),m=Math.min(k,l),n=Math.max(k,l),(f>m||m===f&&n<score2)&&(g.x=b[i].x,g.y=b[i].y,g.width=c,g.height=d,f=m,score2=n,h=!0)),e&&j.width>=d&&j.height>=c&&(k=Math.abs(Math.floor(b[i].width)-d),l=Math.abs(Math.floor(b[i].height)-c),m=Math.min(k,l),n=Math.max(k,l),(f>m||m===f&&n<score2)&&(g.x=b[i].x,g.y=b[i].y,g.width=d,g.height=c,f=m,score2=n,h=!0))}return h===!1&&(f=Number.MAX_VALUE,score2=Number.MAX_VALUE),g},h=b.sprites.slice();h.length>0;){for(var i=Number.MAX_VALUE,j=Number.MAX_VALUE,k=-1,l=new a.Rect(0,0,1,1),m=0;m<h.length;++m){var n=g(e,h[m].width+c,h[m].height+c,d);(i>f||f===i&&score2<j)&&(i=f,j=score2,l=n,k=m)}if(-1===k)throw new Error("Error: Failed to layout atlas element");I(e,l);var o=h[k];o.x=Math.floor(l.x),o.y=Math.floor(l.y),o.rotated=o.width+c!==l.width,h.splice(k,1)}};D.layout=function(b,c,d,e,f){try{switch(c){case a.Atlas.Algorithm.Basic:E(b,e);break;case a.Atlas.Algorithm.Tree:G(b,e,f);break;case a.Atlas.Algorithm.MaxRect:J(b,e,f)}}catch(g){if(d===!1)return void a.error(g.message);if(4096===b.width&&4096===b.height)return void a.error(g.message);b.width===b.height?b.width*=2:b.height=b.width,D.layout(b,c,d,e,f)}};var K=function(a,b){var c=a.width-b.width;return 0===c&&(c=a.name.localeCompare(b.name)),c},L=function(a,b){var c=a.height-b.height;return 0===c&&(c=a.name.localeCompare(b.name)),c},M=function(a,b){var c=a.width*a.height-b.width*b.height;return 0===c&&(c=a.name.localeCompare(b.name)),c},N=function(a,b){return a.name.localeCompare(b.name)},O=function(a,b){var c=a.width;a.height>a.width&&(c=a.height,a.rotated=!0);var d=b.width;b.height>b.width&&(d=b.height,b.rotated=!0);var e=c-d;return 0===e&&(e=a.name.localeCompare(b.name)),e},P=function(a,b){var c=a.height;a.width>a.height&&(c=a.width,a.rotated=!0);var d=b.height;b.width>b.height&&(d=b.width,b.rotated=!0);var e=c-d;return 0===e&&(e=a.name.localeCompare(b.name)),e};D.sort=function(b,c,d,e,f){for(var g=0;g<b.sprites.length;++g){var h=b.sprites[g];h.rotated=!1}var i=d,j=e;if(i===a.Atlas.SortBy.UseBest)switch(c){case a.Atlas.Algorithm.Basic:i=a.Atlas.SortBy.Height;break;case a.Atlas.Algorithm.Tree:i=a.Atlas.SortBy.Area;break;case a.Atlas.Algorithm.MaxRect:i=a.Atlas.SortBy.Area;break;default:i=a.Atlas.SortBy.Height}switch(j===a.Atlas.SortOrder.UseBest&&(j=a.Atlas.SortOrder.Descending),i){case a.Atlas.SortBy.Width:b.sprites.sort(f?O:K);break;case a.Atlas.SortBy.Height:b.sprites.sort(f?P:L);break;case a.Atlas.SortBy.Area:b.sprites.sort(M);break;case a.Atlas.SortBy.Name:b.sprites.sort(N)}j===a.Atlas.SortOrder.Descending&&b.sprites.reverse()},a.AtlasUtils=D;var Q=function(){var b=a.define("Fire.JsonAsset",B).prop("json",null,a.RawType("json"));return b}();a.JsonAsset=Q,a.TextAsset=function(){var b=a.define("Fire.TextAsset",a.Asset,function(){a.Asset.call(this)});return b.prop("text","",a.RawType("text")),b}();var R=function(){var b=a.define("Fire.BitmapFont",a.Asset,null);return b.prop("texture",null,a.ObjectType(a.Texture)),b.prop("charInfos",[]),b.prop("kernings",[]),b.prop("baseLine",0,a.Integer),b.prop("lineHeight",0,a.Integer),b.prop("size",0,a.Integer),b.prop("face",null,a.HideInInspector),b}();a.BitmapFont=R;var S=function(){function b(a,b){this._exporting=b,this.serializedList=[],this._parsingObjs=[],this._parsingData=[],this._objsToResetId=[],j(this,a);for(var c=0;c<this._objsToResetId.length;++c)this._objsToResetId[c].__id__=void 0;this._parsingObjs=null,this._parsingData=null,this._objsToResetId=null}var c=function(a,b){var c=a._parsingObjs.indexOf(b),d=-1!==c;if(d){var e=a.serializedList.length;b.__id__=e,a._objsToResetId.push(b);var f=a._parsingData[c];if(Array.isArray(b)===!1){var g=i(b);g&&(f.__type__=g)}return a.serializedList.push(f),f}},e=function(b,c,d){if(Array.isArray(c))for(var g=0;g<c.length;++g){var h=f(b,c[g]);"undefined"!=typeof h&&d.push(h)}else{var i=c.constructor;if(a._isFireClass(i)){var j=i.__props__;if(j)if("_$erialized"!==j[j.length-1])for(var k=0;k<j.length;k++){var l=j[k],m=a.attr(i,l);m.serializable!==!1&&(b._exporting&&m.editorOnly||(d[l]=f(b,c[l])))}else d.__type__=c._$erialized.__type__,e(b,c._$erialized,d)}else for(var n in c)!c.hasOwnProperty(n)||95===n.charCodeAt(0)&&95===n.charCodeAt(1)||(d[n]=f(b,c[n]))}},f=function(a,b){var c=typeof b;if("object"===c){if(b instanceof FObject){var d=b._objFlags;if(d&m)return void 0;if(a._exporting&&d&n)return void 0}return h(a,b)}return"function"!==c?b:null},g=function(a,b){var c;if(Array.isArray(b))c=[];else{c={};var d=i(b);d&&(c.__type__=d)}var f=a.serializedList.length;if(a._parsingObjs.push(b),a._parsingData.push(c),e(a,b,c),a._parsingObjs.pop(),a._parsingData.pop(),a.serializedList.length>f){var g=a.serializedList.indexOf(c,f);if(-1!==g)return{__id__:g}}return c},h=function(a,b){if(!b)return null;var f=b.__id__;if("undefined"!=typeof f)return{__id__:f};if(b instanceof FObject){if(!b.isValid)return null;var h=b._uuid;if(h)return{__uuid__:h};f=a.serializedList.length,b.__id__=f,a._objsToResetId.push(b);var j={};a.serializedList.push(j);var k=i(b);return k&&(j.__type__=k),e(a,b,j),j._objFlags&=q,{__id__:f}}if(d(b))return null;var l=c(a,b);return l?(f=b.__id__,{__id__:f}):g(a,b)},j=function(b,c){if(c instanceof FObject){var f=c._uuid;"undefined"!=typeof f&&(c._uuid=null),h(b,c),"undefined"!=typeof f&&(c._uuid=f)}else if("object"==typeof c&&c){if(d(c))return a.warn(""+c+" won't be serialized"),void b.serializedList.push(null);var g;if(Array.isArray(c))g=[];else{g={};var j=i(c);j&&(g.__type__=j)}c.__id__=0,b._objsToResetId.push(c),b.serializedList.push(g),e(b,c,g)}else b.serializedList.push(h(b,c))};return b}();a.serialize=function(a,b){var c=b&&b.exporting,d=b&&b.network,e=b&&"stringify"in b?b.stringify:!0,f=b&&b.nicify,g=new S(a,c,d),h=g.serializedList;f&&U(h);var i=1===h.length?h[0]:h;return e===!1?i:JSON.stringify(i,null,2)},a.serialize.asAsset=function(b){b||a.error("[Fire.serialize.asAsset] The uuid must be non-nil!");var c=new B;return c._uuid=b,c},a.serialize.setName=function(a,b){Array.isArray(a)?a[0]._name=b:a._name=b};var T=function(){this.objList=[],this.keyList=[],this.referncedIDList=[],this.referencedCounts=[],this.temporaryDataList=[]},U=function(a){var b=a[0];if("undefined"!=typeof b){var c=new T;c.referencedCounts=new Array(a.length);var d,e,f,g,h,i=a.slice();V(b,a,c);var j=0;for(j=0;j<c.temporaryDataList.length;j++)delete c.temporaryDataList[j]._iN$t;for(j=0;j<c.objList.length;j++)if(e=c.objList[j],d=c.referncedIDList[j],f=c.keyList[j],g=i[d],h=c.referencedCounts[d]>1,!h){e[f]=g;var k=a.indexOf(g);a.splice(k,1)}for(j=0;j<c.objList.length;j++)if(d=c.referncedIDList[j],f=c.keyList[j],e=c.objList[j],h=c.referencedCounts[d]>1){g=i[d];var l=a.indexOf(g);e[f].__id__=l}}};a._nicifySerialized=U;var V=function(a,b,c){if("object"==typeof a){var d;if(a._iN$t=!0,c.temporaryDataList.push(a),Array.isArray(a))for(var e=0;e<a.length;e++)d=a[e],d&&W(d,e,a,b,c);else for(var f in a)d=a[f],d&&W(d,f,a,b,c)}},W=function(a,b,c,d,e){var f,g=a.__id__,h="undefined"!=typeof g;h&&(a=d[g],f=-1!==e.referncedIDList.indexOf(g),f?e.referencedCounts[g]++:e.referencedCounts[g]=1,e.referncedIDList.push(g),e.keyList.push(b),e.objList.push(c));var i=!a._iN$t;i?V(a,d,e):h&&e.referencedCounts[g]++}}(Fire),"undefined"!=typeof module&&module?module.exports=Fire:"function"==typeof define&&define&&define.amd&&define([],function(){return Fire});