function FireWindow(a,b){this._loaded=!1,this.name=a,this.closeWhenBlur=b.closeWhenBlur,this.nativeWin=new BrowserWindow(b),this.closeWhenBlur&&this.nativeWin.setAlwaysOnTop(!0),this.handleEvents(),Fire.App.addWindow(this)}var EventEmitter=require("events"),BrowserWindow=require("browser-window"),Ipc=require("ipc"),Url=require("fire-url");Fire.JS.extend(FireWindow,EventEmitter),Object.defineProperty(FireWindow.prototype,"isMainWindow",{get:function(){return Fire.App.mainWindow===this}}),Object.defineProperty(FireWindow.prototype,"isFocused",{get:function(){return this.nativeWin.isFocused()}}),Object.defineProperty(FireWindow.prototype,"isMinimized",{get:function(){return this.nativeWin.isMinimized()}}),Object.defineProperty(FireWindow.prototype,"isLoaded",{get:function(){return this._loaded}}),FireWindow.prototype.handleEvents=function(){this.nativeWin.on("blur",function(){Fire.AssetDB&&setImmediate(function(){BrowserWindow.getFocusedWindow()||Fire.AssetDB.watchON(),this.closeWhenBlur&&this.nativeWin.close()}.bind(this))}.bind(this)),this.nativeWin.on("focus",function(a){Fire.AssetDB&&Fire.AssetDB.watchOFF()}.bind(this)),this.nativeWin.on("closed",function(){this._loaded=!1,Fire.App.removeWindow(this),this.isMainWindow&&Fire.App.quit()}.bind(this)),this.nativeWin.webContents.on("did-finish-load",function(){this._loaded=!0,this.nativeWin.isFocused()&&Fire.AssetDB&&Fire.AssetDB.watchOFF(),Fire.sendToCore("window-reloaded",this)}.bind(this))},FireWindow.prototype.sendToPage=function(){var a=this.nativeWin.webContents;return a?void a.send.apply(a,arguments):void console.error('Failed to send "%s" to %s because web contents not yet loaded',arguments[0],this.name)},FireWindow.prototype.load=function(a,b){this._loaded=!1;var c=Url.format({protocol:"file",pathname:Fire.url(a),slashes:!0,query:Fire.JS.mixin({fireID:Fire.App.id},b)});this.nativeWin.loadUrl(c)},FireWindow.prototype.show=function(){this.nativeWin.show()},FireWindow.prototype.close=function(){this._loaded=!1,this.nativeWin.close()},FireWindow.prototype.focus=function(){this.nativeWin.focus()},FireWindow.prototype.minimize=function(){this.nativeWin.minimize()},FireWindow.prototype.restore=function(){this.nativeWin.restore()},FireWindow.prototype.openDevTools=function(){this.nativeWin.openDevTools()},module.exports=FireWindow;