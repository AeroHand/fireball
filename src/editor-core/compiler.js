function isScript(a){return".js"===Path.extname(a).toLowerCase()}function isScriptResult(a){return isScript(a.url)}var Path=require("path"),Ipc=require("ipc"),ToolsRunner=require(Fire.url("fire://tools/tools-runner")),RELOAD_WINDOW_SCRIPTS="reload:window-scripts",COMPILE_AND_RELOAD="compiler:compile-and-reload",needRecompile=!1,compilingProcess=null,Compiler={compileScripts:function(a){compilingProcess&&(compilingProcess.kill(),compilingProcess=null);var b=FIRE_PROJECT_PATH,c=["--project="+b,"--debug"];compilingProcess=ToolsRunner.gulp("tools/gulp-compile.js",c,function(b){compilingProcess=null,b&&Fire.log("Compiled successfully"),a&&a(b)})},compileAndReload:function(){this.compileScripts(function(a){Fire.sendToPages(RELOAD_WINDOW_SCRIPTS,a)})}};Ipc.on(COMPILE_AND_RELOAD,function(){Compiler.compileAndReload()}),Ipc.on("assets:deleted",function(a){needRecompile=needRecompile||a.some(isScriptResult)}),Ipc.on("asset:changed",function(a){var b=Fire.AssetDB.uuidToFspath(a);needRecompile=needRecompile||isScript(b)}),Ipc.on("asset:moved",function(a,b){needRecompile=needRecompile||isScript(b)}),Ipc.on("asset:created",function(a,b,c){needRecompile=needRecompile||isScript(a)}),Ipc.on("assets:created",function(a){needRecompile=needRecompile||a.some(isScriptResult)}),Ipc.on("asset-db:synced",function(){needRecompile&&(needRecompile=!1,Compiler.compileAndReload())}),module.exports=Compiler;