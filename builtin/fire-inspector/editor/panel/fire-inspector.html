<html><head></head><body><div hidden=""><polymer-element name="inspector-fields" constructor="InspectorFields" assetpath=""><template><style>:host { display: block; overflow-x: hidden; overflow-y: auto; position: relative;}</style><content></content></template><script>(function(){var warningMessage="The property %s can not show in inspector, because it keeps return new object. Please set visible to false in properties define in this class.";function _fieldSection(name,target,closable){var fireSectionEL=new FireSection;fireSectionEL.name=name;fireSectionEL.closable=closable;fireSectionEL.$={};var isComponent=target instanceof Fire.Component;var isBuiltinComp=isComponent&&!target._scriptUuid;var klass=target.constructor;if(klass.__props__){for(var p=0;p<klass.__props__.length;p++){var propName=klass.__props__[p];var attrs=Fire.attr(klass,propName);if(attrs.hideInInspector){continue}if(isBuiltinComp&&propName==="_scriptUuid"){continue}if(attrs.hasGetter){var val1=target[propName];if(typeof val1==="object"&&val1&&!val1.equals){var val2=target[propName];if(val1!==val2){Fire.warn(warningMessage,propName);continue}}}var propEL=new FireProp;propEL.initWithAttrs(target,propName,attrs);fireSectionEL.$[propName]=propEL;fireSectionEL.appendChild(propEL)}}if(fireSectionEL.closable){fireSectionEL.addEventListener("close",function(event){event.stopPropagation();Editor.sendToMainWindow("engine:remove-component",{"component-id":target.id})})}return fireSectionEL}Polymer("inspector-fields",{created:function(){this.target=null},refresh:function(){while(this.firstElementChild){this.removeChild(this.firstElementChild)}if(!this.target){return}var el;if(this.target instanceof Fire.Asset){el=_fieldSection("Asset",this.target,false);this.appendChild(el)}else if(this.target instanceof Editor.AssetMeta){el=_fieldSection("Meta",this.target,false);this.appendChild(el)}else if(this.target instanceof Fire.Entity){var docfrag=document.createDocumentFragment();for(var i=0;i<this.target._components.length;++i){var comp=this.target._components[i];el=_fieldSection(Fire.JS.getClassName(comp),comp,true);docfrag.appendChild(el)}this.appendChild(docfrag)}}})})();</script></polymer-element><polymer-element name="entity-inspector" constructor="EntityInspector" on-changed="{{fieldsChangedAction}}" on-drop-area-enter="{{dropAreaEnterAction}}" on-drop-area-leave="{{dropAreaLeaveAction}}" on-drop-area-accept="{{dropAreaAcceptAction}}" on-drop-area-dragover="{{dropAreaDragoverAction}}" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; font-size: 12px; margin-top: 2px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #aaa; cursor: default; outline: none; outline: 2px solid transparent;}:host([highlighted]) { outline: 2px solid #0f0;}fire-ui-section { margin-top: 1px;}</style><fire-ui-toolbar class="toolbar"><fire-ui-checkbox value="{{target.active}}"></fire-ui-checkbox><fire-ui-text-input value="{{target.name}}" flex-1=""></fire-ui-text-input><i id="btnAddComp" on-click="{{addComponentAction}}" class="fa fa-plus"></i></fire-ui-toolbar><inspector-fields id="fields" flex-1=""></inspector-fields></template><script>(function(){Polymer("entity-inspector",EditorUI.mixin({publish:{highlighted:{value:false,reflect:true},droppable:"asset","single-drop":true},created:function(){this.target=null},ready:function(){this._initDroppable(this.$.fields)},refresh:function(){this.$.fields.refresh()},targetChanged:function(){this.$.fields.target=this.target;this.refresh()},getAddCompMenuTemplate:function(){function findMenu(menuArray,label){for(var i=0;i<menuArray.length;i++){if(menuArray[i].label===label){return menuArray[i]}}return null}var template=[];var items=Fire._componentMenuItems;for(var i=0;i<items.length;i++){var item=items[i];var subPathes=item.menuPath.split("/");var prio=item.priority||0;var newMenu=null;for(var p=0,parent=template;p<subPathes.length;p++){var label=subPathes[p];if(!label){continue}var parentMenuArray=parent===template?template:parent.submenu;var menu;if(parentMenuArray){if(parentMenuArray.length>0){menu=findMenu(parentMenuArray,label)}if(menu){if(menu.submenu){parent=menu;continue}else{Fire.error("Component menu path %s conflict",item.menuPath);break}}}newMenu={label:label,priority:prio};if(!parentMenuArray){parent.submenu=[newMenu]}else{var length=parentMenuArray.length;if(length>0){for(var j=length-1;j>=0;j--){if(parentMenuArray[j].priority>newMenu.priority){if(j===0){parentMenuArray.unshift(newMenu)}}else{parentMenuArray.splice(j+1,0,newMenu);break}}}else{parentMenuArray.push(newMenu)}}parent=newMenu}if(newMenu&&!newMenu.submenu){newMenu.click=function(component){setImmediate(function(){this.addComponent(component)}.bind(this))}.bind(this,item.component)}else{Fire.error("Invalid component menu path: "+item.menuPath)}}return template},addComponent:function(componentCtor){Editor.sendToMainWindow("engine:add-component",{"entity-id":this.target.id,"component-class-id":Fire.JS._getClassId(componentCtor)})},fieldsChangedAction:function(event,detail){event.stopPropagation();if(detail instanceof Fire.Asset){Fire.AssetLibrary.cacheAsset(detail)}else if(Array.isArray(detail)){for(var i=0;i<detail.length;++i){var item=detail[i];if(item instanceof Fire.Asset){Fire.AssetLibrary.cacheAsset(item)}}}Editor.sendToMainWindow("entity:inspector-dirty");Editor.sendToWindows("scene:repaint")},addComponentAction:function(event){event.stopPropagation();var Remote=require("remote");var Menu=Remote.require("menu");var rect=this.$.btnAddComp.getBoundingClientRect();var x=rect.left;var y=rect.bottom;var template=this.getAddCompMenuTemplate();var menu=Menu.buildFromTemplate(template);menu.popup(Remote.getCurrentWindow(),Math.floor(x),Math.floor(y))},dropAreaEnterAction:function(event){event.stopPropagation();var classDef=Fire.JS.getClassByName(this.type);var dragItems=event.detail.dragItems;var uuid=dragItems[0];var metaJson=Editor.AssetDB.loadMetaJson(uuid);if(metaJson){Fire.AssetLibrary.loadMeta(metaJson,function(err,meta){if(meta instanceof Editor.ScriptAssetMeta){this.highlighted=true}}.bind(this))}},dropAreaLeaveAction:function(event){event.stopPropagation();this.highlighted=false},dropAreaAcceptAction:function(event){event.stopPropagation();if(this.highlighted){this.highlighted=false;var dragItems=event.detail.dragItems;var uuid=dragItems[0];var classID=Editor.compressUuid(uuid);var ctor=Fire.JS._getClassById(classID);if(ctor){this.addComponent(ctor)}}}},EditorUI.droppable))})();</script></polymer-element><polymer-element name="image-preview-field" constructor="ImagePreviewField" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; overflow: hidden;}.view { position: relative; box-shadow: inset 0 0 15px 5px rgba(0,0,0,0.5); background: #292929;}.content { position: absolute; top: 15px; right: 15px; bottom: 15px; left: 15px;}canvas { margin: auto; position: absolute; top: 0; left: 0; bottom: 0; right: 0; display: block; background-image: url("img/checkerboard-32x32.png"); background-size: 32px 32px; background-position: center center;}.label { position: absolute; width: 100%; bottom: 10px; text-align: center;}</style><div class="view" flex-1=""><div id="content" class="content"><canvas id="canvas"></canvas></div><div class="label"><fire-ui-label>{{info}}</fire-ui-label></div></div></template><script>(function(){Polymer("image-preview-field",{publish:{asset:null,meta:null},info:"Unkown",rawTexture:null,resize:function(){if(!this.asset)return;var contentRect=this.$.content.getBoundingClientRect();var result=Fire.fitSize(this.asset.width,this.asset.height,contentRect.width,contentRect.height);this.$.canvas.width=result[0];this.$.canvas.height=result[1];this.repaint()},repaint:function(){var ctx=this.$.canvas.getContext("2d");ctx.imageSmoothingEnabled=false;if(this.asset instanceof Fire.Texture){ctx.drawImage(this.asset.image,0,0,this.$.canvas.width,this.$.canvas.height);var xRatio=this.$.canvas.width/this.asset.width;var yRatio=this.$.canvas.height/this.asset.height;if(this.meta.subRawData){if(this.meta.type===Fire.TextureType.Sprite){this.meta.subRawData.forEach(function(subInfo){if(subInfo.asset instanceof Fire.Sprite){ctx.beginPath();ctx.rect(subInfo.asset.trimX*xRatio,subInfo.asset.trimY*yRatio,subInfo.asset.width*xRatio,subInfo.asset.height*yRatio);ctx.lineWidth=1;ctx.strokeStyle="#ff00ff";ctx.stroke()}})}}}else if(this.asset instanceof Fire.Sprite){if(this.rawTexture){ctx.drawImage(this.rawTexture.image,this.asset.trimX,this.asset.trimY,this.asset.width,this.asset.height,0,0,this.$.canvas.width,this.$.canvas.height)}}},assetChanged:function(){this.info=this.asset.width+" x "+this.asset.height;this.rawTexture=null;this.resize();if(this.asset instanceof Fire.Sprite){Fire.AssetLibrary.loadAssetInEditor(this.meta.rawTextureUuid,function(err,rawTexture){this.rawTexture=rawTexture;this.repaint()}.bind(this));return}}})})();</script></polymer-element><polymer-element name="audio-preview-field" constructor="AudioPreviewField" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; min-height: 100px; overflow: hidden;}.view { position: relative; box-shadow: inset 0 0 15px 5px rgba(0,0,0,0.5); background: #292929;}.content { position: absolute; top: 15px; right: 5px; bottom: 15px; left: 5px;}canvas { margin: auto; position: absolute; top: 0; left: 0; bottom: 0; right: 0; display: block;}.label { position: absolute; width: 100%; bottom: 10px; text-align: center;}#progressBar { position: absolute; margin-left: -4px; margin-right: -4px; width: 10px; height: 100%; cursor: ew-resize;}#progressBar .bar { position: absolute; left: 4px; width: 2px; height: 100%; background-color: #09f; cursor: ew-resize;}.audio-info { position: absolute; right: 5px; top: 4px;}.time-info { position: absolute; right: 5px; bottom: 4px;}.fa-refresh.active { color: #09f;}</style><fire-ui-toolbar style="float:right"><fire-ui-button on-click="{{playAction}}"><i class="fa {{audioSource.isPlaying ? 'fa-pause':'fa-play'}}"></i></fire-ui-button><fire-ui-button on-click="{{stopAction}}"><i class="fa fa-stop"></i></fire-ui-button><fire-ui-button on-click="{{loopAction}}"><i class="fa fa-refresh {{audioSource.loop ? 'active':''}}"></i></fire-ui-button></fire-ui-toolbar><div class="view" flex-1=""><div id="content" class="content" on-mousedown="{{mousedownAction}}"><canvas id="canvas"></canvas><div id="progressBar"><div class="bar"></div></div></div><fire-ui-label class="audio-info">{{audioInfo}}</fire-ui-label><fire-ui-label class="time-info">{{timeInfo}}</fire-ui-label></div></template><script>(function(){Polymer("audio-preview-field",{publish:{asset:null,meta:null},audioInfo:"",timeInfo:"",audioSource:null,contentRectWidth:-1,detached:function(){this.stop()},resize:function(){if(!this.asset)return;var contentRect=this.$.content.getBoundingClientRect();if(Fire.isRetina){this.$.canvas.width=contentRect.width*2;this.$.canvas.height=contentRect.height*2}else{this.$.canvas.width=contentRect.width;this.$.canvas.height=contentRect.height}this.$.canvas.style.width=contentRect.width+"px";this.$.canvas.style.height=contentRect.height+"px";this.contentRectWidth=contentRect.width;this.repaint();this.setProgress(0)},repaint:function(){var ctx=this.$.canvas.getContext("2d");ctx.imageSmoothingEnabled=false;var buffer=this.asset.rawData;var peaks=null;var height=this.$.canvas.height/buffer.numberOfChannels;var yoffset=0;for(var c=0;c<buffer.numberOfChannels;++c){peaks=this.getPeaks(buffer,c,this.$.canvas.width);this.drawWave(ctx,peaks,0,yoffset,this.$.canvas.width,height);if(buffer.numberOfChannels>1){this.drawChannelTip(ctx,c,yoffset)}yoffset+=height}},assetChanged:function(){this.stop();this.audioSource=new Fire.AudioSource;this.audioSource.clip=this.asset;var buffer=this.asset.rawData;this.audioInfo="ch:"+buffer.numberOfChannels+", "+buffer.sampleRate+"Hz, "+this.asset._rawext;this.resize()},play:function(){if(!this.audioSource)return;this.audioSource.play();this.tickProgress()},stop:function(){if(!this.audioSource)return;this.audioSource.stop();this.setProgress(0)},tickProgress:function(){if(!this.audioSource.isPlaying){return}window.requestAnimationFrame(function(){var audioLength=this.audioSource.clip.length;var time=this.audioSource.time%audioLength;var x=time/audioLength*this.contentRectWidth;this.setProgress(x);this.tickProgress()}.bind(this))},drawChannelTip:function(ctx,channel,yOffset){var offset=0;ctx.fillStyle="white";if(Fire.isRetina){ctx.font="24px Arial";offset=24}else{ctx.font="12px Arial";offset=12}ctx.fillText("ch"+(channel+1),4,yOffset+offset)},getPeaks:function(buffer,ch,width){var sampleSize=buffer.length/width;var sampleStep=~~(sampleSize/10)||1;var peaks=new Float32Array(width);var chan=buffer.getChannelData(ch);for(var i=0;i<width;i++){var start=~~(i*sampleSize);var end=~~(start+sampleSize);var max=0;for(var j=start;j<end;j+=sampleStep){var value=chan[j];if(value>max){max=value}else if(-value>max){max=-value}}peaks[i]=max}return peaks},setProgress:function(x){this.$.progressBar.style.transform="translateX("+x+"px)";var audioLength=this.audioSource.clip.length;var date=new Date(x/this.contentRectWidth*audioLength*1e3);this.timeInfo=Fire.padLeft(date.getMinutes(),2,"0")+":"+Fire.padLeft(date.getSeconds(),2,"0")+"."+Fire.padLeft(date.getMilliseconds(),3,"0")},drawWave:function(ctx,peaks,x,y,width,height){var $=0;if(Fire.isRetina){$=.25}else{$=.5}var halfH=height/2;var offsetY=y+halfH;var length=peaks.length;var scale=1;ctx.fillStyle="#ff8e00";if(width!==length){scale=width/length}var i,h;ctx.beginPath();ctx.moveTo($,offsetY);for(i=0;i<length;i++){h=Math.round(peaks[i]*halfH);ctx.lineTo(i*scale+$,offsetY+h)}ctx.lineTo(width+$,offsetY);ctx.moveTo($,offsetY);for(i=0;i<length;i++){h=Math.round(peaks[i]*halfH);ctx.lineTo(i*scale+$,offsetY-h)}ctx.lineTo(width+$,offsetY);ctx.fill();ctx.fillRect(0,offsetY-$,width,$*2)},playAction:function(event){event.stopPropagation();if(this.audioSource.isPlaying){this.audioSource.pause()}else{this.play()}},stopAction:function(event){event.stopPropagation();this.stop()},loopAction:function(event){event.stopPropagation();this.audioSource.loop=!this.audioSource.loop},mousedownAction:function(event){event.stopPropagation();if(event.which===1){var rect=this.$.content.getBoundingClientRect();var startX=rect.left;var width=rect.width;var audioLength=this.audioSource.clip.length;var dx=event.clientX-startX;dx=Math.clamp(dx,0,width);this.audioSource.pause();this.audioSource.time=dx/width*audioLength;this.setProgress(dx);var mousemoveHandle=function(event){event.stopPropagation();var dx=event.clientX-startX;dx=Math.clamp(dx,0,width);this.setProgress(dx)}.bind(this);var mouseupHandle=function(event){event.stopPropagation();var dx=event.clientX-startX;dx=Math.clamp(dx,0,width);this.audioSource.time=dx/width*audioLength;this.play();document.removeEventListener("mousemove",mousemoveHandle);document.removeEventListener("mouseup",mouseupHandle);EditorUI.removeDragGhost()}.bind(this);EditorUI.addDragGhost("ew-resize");document.addEventListener("mousemove",mousemoveHandle);document.addEventListener("mouseup",mouseupHandle)}}})})();</script></polymer-element><polymer-element name="preview-field" constructor="PreviewField" on-resize="{{resizeAction}}" assetpath=""><template><style>:host { position: relative;}:host([hide]) { display: none;}</style></template><script>(function(){Polymer("preview-field",EditorUI.mixin({publish:{asset:null,meta:null,hide:{value:false,reflect:true}},_fieldEL:null,ready:function(){this._initResizable()},resize:function(){if(this._fieldEL)this._fieldEL.resize()},repaint:function(){if(this._fieldEL){this._fieldEL.resize();this._fieldEL.repaint()}},assetChanged:function(){if(this._fieldEL){if(this.asset&&this.asset.constructor===this._fieldEL.asset.constructor){this._fieldEL.meta=this.meta;this._fieldEL.asset=this.asset;return}this._fieldEL.remove();this._fieldEL=null}if(this.asset instanceof Fire.Texture||this.asset instanceof Fire.Sprite){this._fieldEL=new ImagePreviewField}else if(Fire.AudioClip&&this.asset instanceof Fire.AudioClip){this._fieldEL=new AudioPreviewField}if(this._fieldEL){this._fieldEL.setAttribute("fit","");this._fieldEL.meta=this.meta;this._fieldEL.asset=this.asset;this.shadowRoot.appendChild(this._fieldEL)}},resizeAction:function(event){this.resize()}},EditorUI.resizable))})();</script></polymer-element><polymer-element name="importer-inspector" constructor="ImporterInspector" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; font-size: 12px; margin-top: 2px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #aaa; cursor: default; outline: none;}.fields { overflow-x: hidden; overflow-y: auto; position: relative;}span.space { display: block; height: 1px;}fire-ui-splitter::shadow .bar { background: #333;}fire-ui-toolbar { height: 20px;}fire-ui-toolbar .asset-name { overflow-x: hidden;}fire-ui-toolbar fire-ui-button .fa-close { color: #f00;}fire-ui-toolbar fire-ui-button .fa-close:hover { color: #f00;}fire-ui-toolbar fire-ui-button .fa-close:active { color: #f00;}fire-ui-toolbar fire-ui-button .fa-check { color: #0f9;}fire-ui-toolbar fire-ui-button .fa-check:hover { color: #0f9;}fire-ui-toolbar fire-ui-button .fa-check:active { color: #0f9;}fire-ui-toolbar fire-ui-button[disabled] .fa-close,fire-ui-toolbar fire-ui-button[disabled] .fa-check { color: inherit;}</style><fire-ui-resize-wrapper flex-col="" flex-stretch=""><fire-ui-toolbar class="toolbar" justify-end=""><span class="asset-name" flex-1="">{{asset.name}}</span><fire-ui-button disabled="{{!asset.dirty &amp;&amp; !meta.dirty}}" on-click="{{revertAction}}"><i class="fa fa-close"></i></fire-ui-button><fire-ui-button disabled="{{!asset.dirty &amp;&amp; !meta.dirty}}" on-click="{{applyAction}}"><i class="fa fa-check"></i></fire-ui-button></fire-ui-toolbar><div class="fields" flex-1=""><inspector-fields id="metaFields" on-changed="{{metaFieldsChangedAction}}"></inspector-fields><span class="space"></span><inspector-fields id="assetFields" on-changed="{{assetFieldsChangedAction}}"></inspector-fields></div></fire-ui-resize-wrapper><fire-ui-splitter id="splitter"></fire-ui-splitter><preview-field id="preview" asset="{{asset}}" meta="{{meta}}" height="200" min-height="100"></preview-field></template><script>(function(){var Path=require("fire-path");Polymer("importer-inspector",{created:function(){this.asset=null;this.meta=null},resize:function(){if(!this.$.preview.hide){this.$.preview.resize()}},repaint:function(){if(this.$.preview.repaint){this.$.preview.repaint()}},metaChanged:function(){if(this.meta instanceof Editor.TextureMeta||this.meta instanceof Editor.SpriteMeta||this.meta instanceof Editor.AudioClipMeta){this.$.preview.hide=false;this.$.splitter.hide=false}else{this.$.preview.hide=true;this.$.splitter.hide=true}if(this.meta instanceof Editor.FolderMeta||this.meta instanceof Editor.SceneMeta){this.$.metaFields.target=this.meta;this.$.metaFields.refresh();this.asset=null;this.$.assetFields.target=null;this.$.assetFields.refresh()}else{Fire.AssetLibrary.loadAssetInEditor(this.meta.uuid,function(err,asset){if(asset&&this.meta.uuid===asset._uuid){this.$.metaFields.target=this.meta;this.$.metaFields.refresh();this.asset=asset;this.$.assetFields.target=this.asset;this.$.assetFields.refresh()}}.bind(this))}},assetFieldsChangedAction:function(event){event.stopPropagation();if(this.asset){this.asset.dirty=true;Editor.sendToWindows("fire-inspector:asset-dirty",{uuid:this.meta.uuid,json:Editor.serialize(this.asset)})}},metaFieldsChangedAction:function(event){event.stopPropagation();if(this.meta){this.meta.dirty=true;Editor.sendToWindows("fire-inspector:meta-dirty",{uuid:this.meta.uuid,json:Editor.serializeMeta(this.meta)})}},applyAction:function(event){event.stopPropagation();Editor.AssetDB.apply({"meta-json":Editor.serializeMeta(this.meta),"asset-json":Editor.serialize(this.asset),"asset-dirty":this.asset.dirty})},revertAction:function(event){event.stopPropagation();this.fire("reload")}})})();</script></polymer-element><polymer-element name="custom-asset-inspector" constructor="CustomAssetInspector" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; font-size: 12px; margin-top: 2px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #aaa; cursor: default; outline: none;}.spinner { width: 10px; height: 10px; border: 2px solid; border-radius: 50%; border-color: transparent #0080ff #0080ff; -webkit-animation: spin 600ms infinite linear;}.spinner.hide { display: none;}@-moz-keyframes spin { 100% { transform: rotate(360deg); }}@-webkit-keyframes spin { 100% { transform: rotate(360deg); }}@-o-keyframes spin { 100% { transform: rotate(360deg); }}@keyframes spin { 100% { transform: rotate(360deg); }}</style><fire-ui-toolbar class="toolbar" justify-end=""><span class="asset-name" flex-1="">{{asset.name}}</span><div id="spinner" class="spinner {{saving ? '':'hide'}}"></div></fire-ui-toolbar><inspector-fields id="fields" flex-1="" on-changed="{{fieldsChangedAction}}"></inspector-fields></template><script>(function(){Polymer("custom-asset-inspector",{created:function(){this.asset=null;this.meta=null;this.saving=false;this._timeout=null},save:function(){this.saving=true;if(this._timeout){clearTimeout(this._timeout);this._timeout=null}this._timeout=setTimeout(function(){Editor.AssetDB.saveByUuid(this.meta.uuid,Editor.serialize(this.asset))}.bind(this),500)},metaChanged:function(){this.saving=false;if(this._timeout){clearTimeout(this._timeout);this._timeout=null}Fire.AssetLibrary.loadAssetInEditor(this.meta.uuid,function(err,asset){if(!(asset instanceof Fire.CustomAsset)){Fire.error("The asset is corrupted!")}if(asset&&this.meta.uuid===asset._uuid){this.asset=asset;this.$.fields.target=this.asset;this.$.fields.refresh()}}.bind(this))},fieldsChangedAction:function(event){event.stopPropagation();if(this.asset){this.asset.dirty=true;this.save()}}})})();</script></polymer-element></div><polymer-element name="fire-inspector" constructor="FireInspector" on-resize="{{resizeAction}}" on-reload="{{reloadAction}}" on-show="{{showAction}}" assetpath=""><template><style>:host { font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #aaa; cursor: default; outline: none;}</style><content></content></template><script>(function(){var Path=require("fire-path");var Url=require("fire-url");Polymer("fire-inspector",{created:function(){this.target=null;this.icon=new Image;this.icon.src="fire://static/img/plugin-inspector.png"},attached:function(){Editor.mainWindow.$.inspector=this},detached:function(){Editor.mainWindow.$.inspector=null},"asset:changed":function(detail){var uuid=detail.uuid;if(this.target&&this.target.uuid===uuid){var reloadMeta=true;if(this.target instanceof Editor.CustomAssetMeta){if(this.$.inspector.asset&&this.$.inspector.asset.dirty){this.$.inspector.asset.dirty=false;reloadMeta=false}}if(reloadMeta){var metaJson=Editor.AssetDB.loadMetaJson(uuid);Fire.AssetLibrary.loadMeta(metaJson,function(err,meta){this.inspect(meta,true)}.bind(this))}}},"asset:moved":function(detail){var uuid=detail.uuid;var destUrl=detail["dest-url"];if(this.target&&this.target.uuid===uuid){if(this.$.inspector.asset){this.$.inspector.asset.name=Url.basenameNoExt(destUrl)}}},"asset:saved":function(detail){var url=detail.url;var uuid=detail.uuid;if(this.target&&this.target.uuid===uuid){if(this.$.inspector.saving!==undefined){this.$.inspector.saving=false;if(this.$.inspector.asset&&this.$.inspector.asset.dirty){this.$.inspector.asset.dirty=false}}}},"component:added":function(detail){var entityId=detail["entity-id"];var compId=detail["component-id"];this._onEntityDirty(entityId,compId)},"component:removed":function(detail){var entityId=detail["entity-id"];var compId=detail["component-id"];this._onEntityDirty(entityId,compId)},"selection:activated":function(detail){var type=detail.type;var id=detail.id;this._onInspect(type,id)},_onInspect:function(type,id){if(type==="entity"){if(id){var entity=Editor.getInstanceById(id);if(entity){this.inspect(entity)}else{this.inspect(null)}}else if(this.target instanceof Fire.Entity){this.inspect(null)}}else if(type==="asset"){if(id){this.lastUuid=id;var metaJson=Editor.AssetDB.loadMetaJson(id);if(metaJson&&this.lastUuid===id){setImmediate(function(metaJson){if(this.lastUuid===id){Fire.AssetLibrary.loadMeta(metaJson,function(err,meta){this.inspect(meta)}.bind(this))}}.bind(this,metaJson))}}else if(this.target instanceof Editor.AssetMeta){this.inspect(null)}}},_onEntityDirty:function(entityID,componentID){if(this.target&&this.target.id===entityID){var entity=Editor.getInstanceById(entityID);if(entity){this.$.inspector.refresh()}}},inspect:function(obj,force){if(!force){if(this.target===obj){return}if(this.target instanceof Editor.AssetMeta&&obj instanceof Editor.AssetMeta){if(this.target.uuid===obj.uuid){return}}}if(obj&&obj.constructor===Editor.AssetMeta){obj=null}if(this.target){Editor.observe(this.target,false)}if(obj){Editor.observe(obj,true)}var isTargetCustom=this.target instanceof Editor.CustomAssetMeta;var isObjCustom=obj instanceof Editor.CustomAssetMeta;if(isTargetCustom&&isObjCustom){this.target=this.$.inspector.meta=obj}else if(this.target instanceof Editor.AssetMeta&&obj instanceof Editor.AssetMeta&&!isTargetCustom&&!isObjCustom){this.target=this.$.inspector.meta=obj}else if(this.target instanceof Fire.Entity&&obj instanceof Fire.Entity){this.target=this.$.inspector.target=obj}else{while(this.firstElementChild){this.removeChild(this.firstElementChild)}if(obj instanceof Editor.AssetMeta){if(obj instanceof Editor.CustomAssetMeta){this.$.inspector=new CustomAssetInspector;this.target=this.$.inspector.meta=obj}else{this.$.inspector=new ImporterInspector;this.target=this.$.inspector.meta=obj}}else if(obj instanceof Fire.Entity){this.$.inspector=new EntityInspector;this.target=this.$.inspector.target=obj}else{this.$.inspector=null;this.target=null;return}this.$.inspector.setAttribute("fit","");this.appendChild(this.$.inspector)}},reloadAction:function(event){event.stopPropagation();if(this.target&&this.target instanceof Editor.AssetMeta){var metaJson=Editor.AssetDB.loadMetaJson(this.target.uuid);Fire.AssetLibrary.loadMeta(metaJson,function(err,meta){this.inspect(meta,true)}.bind(this))}},resizeAction:function(event){if(this.$.inspector&&this.$.inspector.resize){var old=this.style.display;this.style.display="";this.$.inspector.resize();this.style.display=old}},showAction:function(event){if(this.$.inspector&&this.$.inspector.repaint){this.$.inspector.repaint()}}})})();</script></polymer-element></body></html>