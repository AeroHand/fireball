<html><head></head><body><polymer-element name="build-settings" constructor="BuildSettings" assetpath=""><template><style>.title{width:100%;float:left;background-color:#242424;font-size:18px;line-height:40px;padding-left:15px;border-bottom:1px solid #424242;}.title h2{margin-top:10px;margin-bottom:10px;float:left}.title .tip{color:#f00;font-size:12px;padding-left:100px;display:none;line-height:60px;float:left}.section{width:100%;height:auto;float:left}.prop{height:24px;margin-left:15px;margin-top:10px;margin-right:15px;padding-bottom:10px;border-bottom:1px solid #282828;}.prop fire-ui-label{font-size:13px}.item-box{height:100px;max-height:100px;overflow:hidden;margin-top:5px}.border{border:1px solid #999;position:absolute;max-height:100px;left:191px;width:296px}.items{min-height:80px;border:1px solid #999;overflow-x:hidden;overflow-y:auto;}.items fire-ui-checkbox{margin:3px}.btn-group{width:100%;height:auto;float:left;margin-top:12px;margin-bottom:5px;}.btn-group button{float:right;width:80px;height:30px;margin-right:15px;border:1px solid #252525;border-radius:2px;padding:4px 8px;cursor:pointer;color:#bdbdbd;}.btn-group button li{font-size:20px;cursor:pointer;color:#fff}.btn-group button:focus{outline:none}.btn-group button.green{background-color:#090;}.btn-group button.green:hover{background-color:#00bd00}.btn-group button.green:active{background-color:#008a00}.btn-group button.red{background-color:#900;}.btn-group button.red:hover{background-color:#bd0000}.btn-group button.red:active{background-color:#8a0000}.btn-group .hide{display:none}fire-ui-label{text-align:right;margin-right:20px}</style><div class="title"><h2>Build Settings</h2><span class="tip" id="tip">
            Please enter the correct data!
        </span></div><div class="section"><div flex-row="" class="prop"><fire-ui-label flex-1="">Project Name</fire-ui-label><fire-ui-text-input value="{{settings.projectName}}" invalid="{{!isProjectNameValid}}" placeholder="Project Name" flex-2=""></fire-ui-text-input></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Build Path</fire-ui-label><div flex-row="" flex-2=""><fire-ui-text-input value="{{settings.buildPath}}" invalid="{{!isBuildPathValid}}" placeholder="Building Path" flex-4=""></fire-ui-text-input><fire-ui-button style="margin-left: 10px" on-click="{{chooseDistPath}}">Open...</fire-ui-button></div></div><div flex-row="" class="prop"><fire-ui-label id="test" flex-1="">Start scene</fire-ui-label><fire-ui-select flex-2="" value="{{settings.defaultScene}}" options="{{settings.sceneList}}"></fire-ui-select></div><div flex-row="" class="prop item-box"><fire-ui-label flex-1="">Scenes</fire-ui-label><div flex-2="" class="items"><template repeat="{{item in settings.sceneList}}"><fire-ui-checkbox disabled="{{item.value == settings.defaultScene}}" on-click="{{itemClickAction}}" value="{{!item.ignore}}" id="{{item.value}}">{{item.name}}</fire-ui-checkbox></template></div></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Enable Debug</fire-ui-label><fire-ui-checkbox flex-2="" value="{{settings.isDebug}}"></fire-ui-checkbox></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Platform</fire-ui-label><fire-ui-select flex-2="" value="{{settings.platform}}" options="{{platformList}}"></fire-ui-select></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Platform Config</fire-ui-label><fire-ui-select flex-2="" value="{{settings.platformConfig}}" options="{{platformConfigList}}"></fire-ui-select></div></div><div class="btn-group"><button class="green" on-mouseenter="{{buildButtonHoverInAction}}" on-mouseleave="{{buildButtonHoverOutAction}}" on-click="{{buildAction}}"><span class="{{hoverBuildButton? 'hide':''}}">Build</span><li class="fa fa-download {{!hoverBuildButton? 'hide':''}}"></li></button><button class="red" on-click="{{closeAction}}">Close</button></div></template><script>!function(){var a=require("remote"),b=require("fire-url"),c=require("fire-fs"),d=require("fire-path");Polymer("build-settings",{platformList:[{name:"PC",value:"PC"},{name:"Mobile",value:"Mobile"}],platformConfigList:[{name:"Builder.js",value:"Builder.js"},{name:"Builder.Platform",value:"Builder.Platform"}],observe:{"settings.defaultScene":"defaultSceneChanged","settings.buildPath":"buildPathChanged","settings.projectName":"projectNameChanged"},isProjectNameValid:!0,isBuildPathValid:!0,hoverBuildButton:!1,created:function(){this.ipc=new Fire.IpcListener,this.settings={projectName:"",defaultScene:"",sceneList:[],isDebug:!0,platform:"Mobile",platformConfig:"Builder.Platform",buildPath:""};var b=a.getGlobal("FIRE_PROJECT_PATH");this.settingPath=d.join(b,"settings")+"/build-settings.json";var c=!1;this.loadConfig(function(a,b,d){b?c=!1:(this.settings.isDebug=a.isDebug,this.settings.defaultScene=a.defaultScene,this.settings.buildPath=a.buildPath,this.settings.platform=a.platform,this.settings.platformConfig=a.platformConfig,this.settings.projectName=a.projectName,this.settings.sceneList=a.sceneList,c=!0)}.bind(this)),c||(this.settings.projectName=d.basename(b),this.settings.buildPath=b)},attached:function(){Fire.sendToCore("build-settings:query-scenes"),this.ipc.on("build-settings:query-scenes-results",function(a){this.settings.sceneList=[];for(var b=0;b<a.length;++b){var c=a[b];this.settings.sceneList.push({name:c.url,value:c.uuid,ignore:!1})}this.settings.defaultScene=this.settings.sceneList[0].value}.bind(this))},detached:function(){this.ipc.clear()},defaultSceneChanged:function(){for(var a=0;a<this.settings.sceneList.length;++a)this.settings.sceneList[a].value===this.settings.defaultScene&&(this.settings.sceneList[a].ignore=!1)},buildPathChanged:function(){this.isBuildPathValid=c.isDirSync(this.settings.buildPath)},projectNameChanged:function(){return this.settings.projectName?void(this.isProjectNameValid=!0):void(this.isProjectNameValid=!1)},chooseDistPath:function(){var b=a.require("dialog"),c=a.getGlobal("FIRE_PROJECT_PATH");b.showOpenDialog({defaultPath:c,properties:["openDirectory","multiSelections"]},function(a){a&&(this.settings.buildPath=a)}.bind(this))},saveConfig:function(){var a=JSON.stringify(this.settings,null,2);c.writeFile(this.settingPath,a,"utf8",function(a){return a?void Fire.error(a.message):void 0}.bind(this))},loadConfig:function(a){var b=c.existsSync(this.settingPath);b&&c.readFile(this.settingPath,"utf8",function(b,c){try{c=JSON.parse(c)}catch(d){return Fire.error(d),void a(c,!0,d)}a(c,!1)})},buildAction:function(){if(this.isProjectNameValid&&this.isBuildPathValid){this.$.tip.style.display="none",this.saveConfig();var a=this.settings.sceneList.filter(function(a){return!a.ignore});Fire.warn("@Jare please fill building code here...")}else this.$.tip.style.display="block",this.$.tip.animate([{color:"white"},{color:"red"},{color:"white"},{color:"red"}],{duration:300})},buildButtonHoverInAction:function(a){this.hoverBuildButton=!0},buildButtonHoverOutAction:function(){this.hoverBuildButton=!1},closeAction:function(){window.close()}})}();</script></polymer-element></body></html>